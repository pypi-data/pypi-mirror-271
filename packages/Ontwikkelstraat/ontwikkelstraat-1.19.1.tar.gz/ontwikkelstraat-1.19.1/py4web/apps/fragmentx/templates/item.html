<div class="container is-fullhd">
    <div class="columns m-0 has-background-white is-multiline" style="padding-bottom: 10rem;">
        <div class="column is-12 is-8-widescreen p-6 px-2-mobile is-flex is-flex-direction-column">
            <article class="p-6 px-0-mobile" id="[[=item.id]]">
                <div class="is-relative mb-6">
                    <figure class="edwh-placeholder image is-fullwidth">
                        <img src="[[=thumbnail(item)]]" alt="[[=item.name]]">
                    </figure>
                    <div class="edwh-stickers" style="position: absolute;">
                        [[for sticker in item.stickers:]]
                        [[if sticker.svg:]]
                        <div style="cursor: pointer;" title="[[=sticker.sticker_tag.name]]"
                             class="is-pulled-right"
                             _="install Sticker(id: '[[=sticker.sticker_tag.id]]')"
                        >
                            <!-- object kan geen onclick, dus vandaar een div + a er om heen -->
                            <div title="[[=sticker.sticker_tag.name]]" style="display: block; z-index: 1;">
                                <object id="svg-[[=sticker.id]]" data="[[=sticker.uri]]"
                                        class="edwh-sticker"
                                        style="z-index: -1; pointer-events: none;"
                                        type="image/svg+xml">
                                </object>
                            </div>
                        </div>
                        [[else:]]
                        <img
                                style="cursor: pointer;"
                                _="install Sticker(id:'[[=sticker.sticker_tag.id]]')"

                                id="[[=sticker.id]]"
                                src="[[=sticker.uri]]"
                                class="edwh-sticker"
                                alt="[[=sticker.sticker_tag.name]]" title="[[=sticker.sticker_tag.name]]">
                        [[pass]]
                        [[pass]]
                    </div>
                </div>
                <div class="columns m-0 pt-5 is-flex-direction-column">
                    <div class="edwh-item-icon is-flex is-justify-content-space-between is-align-items-start mb-1">
                        <h1 class="title is-size-3 p-0 pr-3 m-0">[[=item.name]]</h1>
                        <form
                                [[if anonymous:]]
                                _="install Auth"
                                [[else:]]
                                hx-trigger="ew:submit throttle:500ms"
                                hx-post="like"
                                hx-target="find .edwh-like-feedback"
                                _="install LikeButton(item_id: '[[=item.id]]')"
                                [[pass]]
                        >
                            <input type="hidden" value="[[=item.id]]" name="subject"/>
                            <input type="hidden" name="toggle"/>
                            <input type="hidden" value="THUMBS" name="action"/>

                            <a
                                    [[if has_my_thumb(item):]]
                                    class="is-flex thumbs-UP edwh-like-btn"
                                    [[else:]]
                                    class="is-flex edwh-like-btn"
                                    [[pass]]
                            >
                                <svg viewBox="0 0 17.806 15.713"
                                     class="edwh-icon">
                                    <path
                                            d="M16.383 1.423a4.784 4.784 0 00-6.81 0l-.67.67-.67-.67a4.815 4.815 0 00-6.81 6.81l7.48 7.48 7.48-7.48a4.784 4.784 0 000-6.81"
                                            fill="#25303D" fill-rule="evenodd" data-name="Symbol 66"></path>
                                </svg>
                                <span class="ml-2" style="display: inherit; color: black !important">(
                            <span class="edwh-like-count" data-gid="[[=item.id]]">
                                [[=thumb_count(item)]]
                            </span>)</span>
                                <span class="edwh-like-feedback"></span>
                            </a>
                        </form>
                    </div>
                    <div class="subtitle">
                        <span>
                        [[if item.time_to_read:]]
                            [[=item.time_to_read]] min |
                        [[else:]]
                            < 1 min |
                        [[pass]]
                        Laatste bewerking: [[=item.ts_changed_hf]] |
                        [[if 'cc-' in item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/cc-general.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if '-by' in item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/cc-by.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if '-sa' in item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/cc-sa.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if '-nd' in item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/cc-nd.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if '-nc' in item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/cc-nc-eu.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if 'pd' == item.license:]]
                         <object data="[[=PY4WEB_URL('static/images/pd.svg')]]"
                                 style="height: 1rem; transform: translateY(5%);"></object>
                        [[pass]]
                        [[if 'copyright' == item.license:]]
                         &copy;
                        [[pass]]
                                </span>

                    </div>
                    <div class="edwh-item-firstline my-5">[[=XML(item.firstline)]]</div>
                    <div class="content">[[=XML(item.shorter_body)]]</div>
                    [[if item.attachments:]]
                    <div class="edwh-item-title has-text-orange">Documenten</div>
                    <div class="columns is-multiline is-mobile">
                        [[for attachment in item.attachments:]]
                        [[if attachment.uri:]]
                        <div class="column is-12-mobile is-6-tablet is-6-desktop is-4-widescreen">
                            <div class="box has-bg-blue-light"
                                 style="border-radius: 0.5em; box-shadow: none; color: #F4F7FC; display: block; padding: 1.25rem; border: 0.25em solid #ED7959;">
                                <a class="columns is-mobile" href="[[=attachment.uri]]" target="_blank"
                                   title="Download [[=attachment.filename]]">
                                    <div class="column is-9">
                                        <div class="title is-size-6 has-text-orange">[[=attachment.filename]]
                                        </div>
                                    </div>
                                    <div class="column p-0 m-auto">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                             class="m-auto is-block"
                                             style="height: 2.5rem; width: 2.5rem;">
                                            <defs>
                                                <style>.a {
                                                    fill: none;
                                                    stroke: #ff704f;
                                                    stroke-linecap: round;
                                                    stroke-linejoin: round;
                                                    stroke-width: 1.5px;
                                                }</style>
                                            </defs>
                                            <title>download-circle</title>
                                            <polyline class="a"
                                                      points="8.25 14.25 12 18 15.75 14.25"></polyline>
                                            <line class="a" x1="12" y1="6.75" x2="12"
                                                  y2="18"></line>
                                            <circle class="a" cx="12" cy="12" r="11.25"></circle>
                                        </svg>
                                    </div>
                                </a>
                            </div>
                        </div>
                        [[pass]]
                        [[pass]]
                    </div>
                    [[pass]]
                    [[if item.backgrounds:]]

                    <div class="edwh-item-title has-text-orange">Media</div>
                    <div class="columns is-multiline is-mobile">
                        [[for background in item.backgrounds:]]
                        [[if background.uri:]]
                        <div class="column is-6-mobile is-6-tablet is-4-desktop is-3-widescreen">
                            <figure class="edwh-placeholder">
                                <img class="edwh-modaltoggle" src="[[=background.uri]]" alt="[[=background.filename]]"
                                     _="on click set #modal_image's src to my src then call modal(#openimage)"
                                >
                            </figure>
                        </div>
                        [[pass]]
                        [[pass]]
                    </div>

                    [[pass]]
                </div>


            </article>

            <!--?            <a class="button is-outlined mx-auto is-rounded" ><span class="is-flex py-auto mr-2"><object data="[[=URL('static/images/pencil-solid.svg')]]" style="height: 1em; width: 1em;"></object></span><span>Een bewerking voorstellen</span></a>-->

        </div>
        <div class="column is-12 is-4-widescreen has-bg-blue-light p-0" style="border-bottom-left-radius: 3rem;">
            <div id="map" data-lonlat="[[=get_org_info('lonlat', '')]]" style="height: 25rem; z-index: 1;"></div>
            <div class="columns is-mobile m-0 mt-3 px-4">
                <div class="column is-narrow is-flex-shrink-1">
                    <figure class="image is-flex">
                        <img
                                src="[[=avatar_url(item.author)]]"
                                alt=""
                                class="m-auto"/>
                    </figure>
                </div>
                <div class="column is-9 p-0">
                    <div class="columns is-multiline m-0">
                        <div class="column is-12">
                            <div class="has-text-weight-bold has-text-blue">
                                [[=item.author.name]]
                            </div>
                        </div>
                        <div class="column is-12">
                            <div class="columns is-multiline is-variable is-1">
                                <div class="column is-6">
                                    [[if item.is_without_email:]]
                                    <a _="on click call modal(#claim_ownership)"
                                       class="button is-rounded has-text-white has-bg-orange has-text-weight-semibold"
                                       style="width: 100%;  border: none;">
                                        <span>Ik werk hier</span>
                                    </a>
                                    [[else:]]
                                    <a [[if anonymous:]]
                                       _="install Auth"
                                       [[else:]]
                                       _="on click call modal(#contactme)"
                                       [[pass]]
                                       class="button is-rounded has-text-white has-bg-orange has-text-weight-semibold"
                                       style="width: 100%;  border: none;">
                                            <span class="icon my-auto mr-2">
                                                 <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 21.75"><g
                                                         id="c"><path
                                                         d="M10.34,12.16C2.83,6.7,2.25,6.22,.52,4.87c-.33-.26-.52-.65-.52-1.07v-1.08C0,1.22,1.22,0,2.72,0H26.28c1.5,0,2.72,1.22,2.72,2.72v1.08c0,.42-.19,.82-.52,1.07-1.73,1.36-2.31,1.83-9.82,7.29-.95,.69-2.84,2.37-4.16,2.34-1.31,.02-3.21-1.65-4.16-2.34ZM29,7.45v11.58c0,1.5-1.22,2.72-2.72,2.72H2.72c-1.5,0-2.72-1.22-2.72-2.72V7.45c0-.28,.32-.44,.55-.27,1.27,.99,2.95,2.24,8.73,6.43,1.19,.87,3.21,2.71,5.22,2.7,2.02,.02,4.08-1.86,5.23-2.7,5.78-4.2,7.45-5.45,8.72-6.44,.22-.17,.55-.01,.55,.27Z"
                                                         fill="#fff"/></g></svg>
                                            </span> <span>Contact</span>
                                    </a>
                                    [[pass]]

                                </div>
                                <!--
                                <div class="column is-6"><a href="[[=user_uri_template(item.author.id)]]"
                                                            class="button is-rounded has-text-blue has-bg-yellow has-text-weight-semibold"
                                                            style="width: 100%; border: none;">
                                    <span class="icon my-auto mr-2">
                                        [[
                                        def profiel_icoon_url_for(user):
                                            return URL('static/images/users-solid.svg' if item.author.name.lower().startswith('team ') else 'static/images/user-solid.svg')
                                        pass
                                        ]]
                                         <object data="[[=profiel_icoon_url_for(item.author)]]" height="100%"
                                                 width="100%"></object>
                                    </span> <span>Profiel</span>
                                </a></div>
                                -->
                                <!--[[for org_tag in item.organisation_tags:]]
                                    <div class="column is-12">
                                        <div class="has-text-weight-bold has-text-blue">
                                            [[=org_tag.name]]
                                        </div>
                                    </div>
                                [[pass]]-->
                                <div class="column is-12 has-text-weight-light has-text-blue pt-5">
                                    <div class="is-flex mb-5"><span class="icon my-auto mr-3">
                                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.5 22"><g id="c"><path
                                                 d="M0,8.25C0,3.69,3.69,0,8.25,0s8.25,3.69,8.25,8.25c0,3.33-1.16,4.25-7.4,13.31-.41,.59-1.29,.59-1.7,0C1.16,12.5,0,11.58,0,8.25Zm11.69,0c0-1.9-1.54-3.44-3.44-3.44s-3.44,1.54-3.44,3.44,1.54,3.44,3.44,3.44,3.44-1.54,3.44-3.44Z"
                                                 fill="#26303d"/></g></svg>
                                    </span>[[#plaatsnaam van de school]]
                                        [[=get_org_info('city','In onderzoek').capitalize()]]
                                    </div>
                                    <div class="is-flex mb-5"><span class="icon my-auto mr-3">
                                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.5 22"><g id="c"><path
                                                 d="M16.1,5.1l-4.07,4.07v11.46c0,.76-.62,1.38-1.38,1.38h-.69c-.76,0-1.38-.62-1.38-1.38v-4.81h-.69v4.81c0,.76-.62,1.38-1.38,1.38h-.69c-.76,0-1.38-.62-1.38-1.38V9.16L.4,5.1C-.13,4.56-.13,3.69,.4,3.15c.54-.54,1.41-.54,1.94,0l3.72,3.72h4.36l3.72-3.72c.54-.54,1.41-.54,1.94,0,.54,.54,.54,1.41,0,1.95ZM8.25,0c1.71,0,3.09,1.38,3.09,3.09s-1.39,3.09-3.09,3.09-3.09-1.38-3.09-3.09S6.54,0,8.25,0Z"
                                                 fill="#26303d"/></g></svg>
                                    </span>[[#getal of None]][[=get_org_info('student_count','In onderzoek')]]
                                    </div>
                                    <div class="is-flex mb-5"><span class="icon my-auto mr-3">
                                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g id="c"><path
                                                 d="M22,4.6v1.59c0,.38-.31,.69-.69,.69H.69c-.38,0-.69-.31-.69-.69v-1.59c0-.29,.19-.55,.45-.64L10.52,.09c.15-.06,.31-.09,.48-.09s.33,.03,.48,.09l10.07,3.87c.27,.1,.45,.36,.45,.64Zm0,15.34v1.38c0,.38-.31,.69-.69,.69H.69c-.38,0-.69-.31-.69-.69v-1.38c0-.38,.31-.69,.69-.69H21.31c.38,0,.69,.31,.69,.69ZM5.5,8.25v6.88h4.12v-6.88h2.75v6.88h4.12v-6.88h2.75v6.88h.69c.38,0,.69,.31,.69,.69v2.06H1.38v-2.06c0-.38,.31-.69,.69-.69h.69v-6.88h2.75Z"
                                                 fill="#26303d"/></g></svg>
                                    </span>[[#Een lijst van onderwijsniveaus]]
                                        [[=','.join(get_org_info('education_level',[])) or 'In onderzoek']]
                                    </div>
                                    <div class="is-flex mb-5"><span class="icon my-auto mr-3">
                                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g id="c"><path
                                                 d="M10.31,10.85v10.57c0,.44-.48,.71-.88,.51-2.62-1.32-6.42-1.68-8.29-1.78-.64-.03-1.14-.55-1.14-1.16V9.42c0-.67,.58-1.2,1.28-1.16,2.08,.12,6.21,.55,8.76,2.11,.18,.11,.28,.29,.28,.49Zm.69-2.6c-2.28,0-4.12-1.85-4.12-4.12S8.72,0,11,0s4.12,1.85,4.12,4.12-1.85,4.12-4.12,4.12Zm11,1.17v9.57c0,.62-.5,1.13-1.14,1.16-1.88,.1-5.67,.46-8.29,1.78-.4,.2-.88-.07-.88-.51V10.86c0-.2,.1-.39,.28-.5,2.55-1.56,6.68-1.99,8.76-2.11,.7-.04,1.28,.49,1.28,1.16Z"
                                                 fill="#26303d"/></g></svg>
                                    </span>[[#1 onderwijstype]][[=get_org_info('education_type','In onderzoek')]]
                                    </div>

                                </div>
                                <div class="column is-12 has-text-weight-light has-text-blue p-0">
                                    Deze informatie is afkomstig van DUO.
                                </div>
                            </div>


                        </div>
                    </div>

                </div>
            </div>
            <div class="columns is-multiline m-0 mt-3 px-4">
                <div class="column is-full">
                    <div class="has-bg-yellow-light" style="border-radius: 1rem; height: 0.75rem"></div>
                </div>
                <div class="column is-full mb-5" id="onderbouwing">
                    <span class="has-text-blue is-size-5 has-text-weight-bold">Wetenschappelijke onderbouwing</span>
                    <div class="columns is-mobile is-multiline mt-3 p-5">
                        <div class="column is-full p-0 mb-2"
                             data-type="[[='active' if item.onderbouwing == 'EKeE' else 'inactive']]"
                             _="install Onderbouwing"
                             style="border-radius: 1.5rem; pointer-events: none;">
                            <div class="has-text-weight-bold has-text-blue-light is-flex is-size-5 my-3 mx-5"><span
                                    class="icon my-auto mr-3">
                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g id="c"><path
                                 d="M12.95,4.28l4.77,4.77c.2,.2,.2,.53,0,.73L6.43,21.07l-5.22,.92c-.71,.12-1.32-.49-1.19-1.19l.91-5.22L12.21,4.28c.2-.2,.53-.2,.73,0ZM3.78,16.15h-1.56l-.49,2.77,1.34,1.34,2.77-.49v-1.56H3.78v-2.06Zm2.4-1.55l6.62-6.62c.24-.24,.24-.62,0-.85s-.61-.24-.85,0l-6.62,6.62c-.24,.24-.24,.62,0,.85s.61,.24,.85,0Zm13.23-6.52c-.2,.2-.53,.2-.73,0L13.91,3.31c-.2-.2-.2-.53,0-.73l1.98-1.98c.8-.8,2.11-.8,2.92,0l2.58,2.58c.81,.8,.81,2.11,0,2.92l-1.98,1.98Z"
                                 fill="#9badbc"/></g></svg>
                        </span> <span class="mr-3">Gebaseerd op eigen kennis en ervaring</span>
                            </div>
                        </div>
                        <div class="column is-full p-0 mb-2"
                             data-type="[[='active' if item.onderbouwing == 'GOW' else 'inactive']]"
                             _="install Onderbouwing"
                             style="border-radius: 1.5rem;">
                            <div class="has-text-weight-bold has-text-blue-light is-flex is-size-5 my-3 mx-5"><span
                                    class="icon my-auto mr-3">
                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.62 20.62"><g id="c"><path
                                 d="M20.52,7.79l-1.46,1.46c-.13,.13-.35,.13-.49,0l-.48-.48L7.51,19.33c-.86,.86-2,1.29-3.13,1.29-1.24,0-2.48-.51-3.37-1.54-1.53-1.78-1.26-4.5,.4-6.17L11.83,2.52l-.48-.48c-.13-.13-.13-.35,0-.49L12.81,.1c.13-.13,.35-.13,.49,0l7.23,7.21c.13,.13,.13,.35,0,.48Zm-3.88-.46l-3.37-3.36-6.36,6.35h6.75l2.99-2.98Z"
                                 fill="#9badbc"/></g></svg>
                        </span><span class="mr-3">Gebaseerd op wetenschappelijke inzichten en/of theorie</span> <span
                                    class="icon toggle is-hidden my-auto ml-auto py-1">
                      <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.47 12.42"><g id="c"><path
                              d="M20.14,9.44c.44,.44,.44,1.15,0,1.59l-1.06,1.06c-.44,.44-1.15,.44-1.59,0l-7.25-7.22L2.98,12.1c-.44,.44-1.15,.44-1.59,0l-1.06-1.06c-.44-.44-.44-1.15,0-1.59L9.44,.33c.44-.44,1.15-.44,1.59,0l9.11,9.11Z"
                              fill="#9badbc"/></g></svg>
                    </span>
                            </div>
                            <div class="has-bg-blue-light toggle m-1 mt-3"
                                 style="border-bottom-left-radius: 1.5rem; border-bottom-right-radius: 1.5rem;">
                                <div class="columns is-mobile m-0 mx-4 pl-1">
                                    <div class="column px-0 is-narrow">
                                        <span class="has-text-blue has-text-weight-bold">Bronnen:</span>
                                    </div>
                                    <div class="column content">
                                        <ul class="m-0">
                                            [[for attachment in item.onderbouwing_bronnen:]]
                                            <li><a target="_blank"
                                                   href="[[=attachment.uri]]">[[=attachment.filename]]</a></li>
                                            [[pass]]
                                            [[for link in item.onderbouwing_links:]]
                                            <li><a target="_blank" href="[[=link]]">[[=link]]</a></li>
                                            [[pass]]
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-full p-0 mb-2"
                             data-type="[[='active' if item.onderbouwing == 'EBE' else 'inactive']]"
                             _="install Onderbouwing"
                             style="border-radius: 1.5rem;">
                            <div class="has-text-weight-bold has-text-blue-light is-flex is-size-5 my-3 mx-5"><span
                                    class="icon my-auto mr-3">
                                <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22"><g id="c"><path
                                        d="M6.88,14.15L.07,20.96c-.03-.11-.07-.22-.07-.33V1.38C0,.62,.62,0,1.38,0H5.5c.76,0,1.38,.62,1.38,1.38v1.38h-2.41c-.19,0-.34,.15-.34,.34v.69c0,.19,.15,.34,.34,.34h2.41v2.75h-2.41c-.19,0-.34,.15-.34,.34v.69c0,.19,.15,.34,.34,.34h2.41v2.75h-2.41c-.19,0-.34,.15-.34,.34v.69c0,.19,.15,.34,.34,.34h2.41v1.78Zm15.12,2.35v4.12c0,.76-.62,1.38-1.38,1.38H1.38c-.12,0-.23-.04-.33-.07l6.81-6.81h1.78v2.41c0,.19,.15,.34,.34,.34h.69c.19,0,.34-.15,.34-.34v-2.41h2.75v2.41c0,.19,.15,.34,.34,.34h.69c.19,0,.34-.15,.34-.34v-2.41h2.75v2.41c0,.19,.15,.34,.34,.34h.69c.19,0,.34-.15,.34-.34v-2.41h1.38c.76,0,1.38,.62,1.38,1.38Z"
                                        fill="#9badbc"/></g></svg>
                                </span>
                                <span class="mr-3">Werkzame principes zijn elders aangetoond</span>
                                <span class="icon toggle is-hidden my-auto ml-auto py-1">
                                    <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.47 12.42"><g id="c"><path
                                            d="M20.14,9.44c.44,.44,.44,1.15,0,1.59l-1.06,1.06c-.44,.44-1.15,.44-1.59,0l-7.25-7.22L2.98,12.1c-.44,.44-1.15,.44-1.59,0l-1.06-1.06c-.44-.44-.44-1.15,0-1.59L9.44,.33c.44-.44,1.15-.44,1.59,0l9.11,9.11Z"
                                            fill="#9badbc"/></g>
                                    </svg>
                                </span>
                            </div>
                            <div class="has-bg-blue-light toggle m-1 mt-3"
                                 style="border-bottom-left-radius: 1.5rem; border-bottom-right-radius: 1.5rem;">
                                <div class="columns is-mobile m-0 mx-4 pl-1">
                                    <div class="column px-0 is-narrow">
                                        <span class="has-text-blue has-text-weight-bold">Bronnen:</span>
                                    </div>
                                    <div class="column content">
                                        <ul class="m-0">
                                            [[for attachment in item.onderbouwing_bronnen:]]
                                            <li><a target="_blank"
                                                   href="[[=attachment.uri]]">[[=attachment.filename]]</a></li>
                                            [[pass]]
                                            [[for link in item.onderbouwing_links:]]
                                            <li><a target="_blank" href="[[=link]]">[[=link]]</a></li>
                                            [[pass]]
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-full p-0"
                             data-type="[[='active' if item.onderbouwing == 'HBE' else 'inactive']]"
                             _="install Onderbouwing"
                             style="border-radius: 1.5rem;">
                            <div class="has-text-weight-bold has-text-blue-light is-flex is-size-5 my-3 mx-5"><span
                                    class="icon my-auto mr-3">
                         <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.96 26.66"><g id="c"><g><path
                                 d="M4.43,6.54C4.43,2.93,7.36,0,10.98,0s6.54,2.93,6.54,6.54c0,2.64-.92,3.37-5.87,10.55-.32,.47-1.02,.47-1.34,0-4.95-7.18-5.87-7.92-5.87-10.55Zm9.27,0c0-1.51-1.22-2.73-2.73-2.73s-2.73,1.22-2.73,2.73,1.22,2.73,2.73,2.73,2.73-1.22,2.73-2.73Z"
                                 fill="#9badbc"/><g><path d="M6.55,9.63h-1.32c.31,.57,.75,1.24,1.32,2.08v-2.08Z"
                                                          fill="#9badbc"/><path
                                 d="M4.66,8.32h1.89v-1.31c0-.72-.59-1.31-1.31-1.31h-.75c-.04,.28-.06,.55-.06,.84,0,.67,.06,1.22,.23,1.78Z"
                                 fill="#9badbc"/><path
                                 d="M6.55,17.49h-2.29c-.18,0-.33-.15-.33-.33v-.65c0-.18,.15-.33,.33-.33h2.29v-2.62h-2.29c-.18,0-.33-.15-.33-.33v-.66c0-.18,.15-.33,.33-.33h1.45c-.76-1.12-1.29-1.95-1.64-2.7-.08-.06-.14-.14-.14-.25v-.06c-.37-.88-.5-1.66-.5-2.7,0-.28,.02-.56,.05-.84H1.31c-.72,0-1.31,.59-1.31,1.31V25.35c0,.11,.04,.21,.06,.32l6.49-6.48v-1.69Z"
                                 fill="#9badbc"/><path
                                 d="M19.65,20.11h-1.31v2.29c0,.18-.15,.33-.33,.33h-.66c-.18,0-.33-.15-.33-.33v-2.29h-2.62v2.29c0,.18-.15,.33-.33,.33h-.65c-.18,0-.33-.15-.33-.33v-2.29h-2.62v2.29c0,.18-.15,.33-.33,.33h-.66c-.18,0-.33-.15-.33-.33v-2.29h-1.69L.99,26.6c.11,.03,.21,.06,.32,.06H19.65c.72,0,1.31-.59,1.31-1.31v-3.93c0-.72-.59-1.31-1.31-1.31Z"
                                 fill="#9badbc"/></g></g></g></svg>
                        </span><span class="mr-3">Werkzame principes zijn bij ons aangetoond</span><span
                                    class="icon toggle is-hidden my-auto ml-auto py-1">
                      <svg id="b" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20.47 12.42"><g id="c"><path
                              d="M20.14,9.44c.44,.44,.44,1.15,0,1.59l-1.06,1.06c-.44,.44-1.15,.44-1.59,0l-7.25-7.22L2.98,12.1c-.44,.44-1.15,.44-1.59,0l-1.06-1.06c-.44-.44-.44-1.15,0-1.59L9.44,.33c.44-.44,1.15-.44,1.59,0l9.11,9.11Z"
                              fill="#9badbc"/></g></svg>
                    </span>
                            </div>
                            <div class="has-bg-blue-light toggle m-1 mt-3"
                                 style="border-bottom-left-radius: 1.5rem; border-bottom-right-radius: 1.5rem;">
                                <div class="columns is-mobile m-0 mx-4 pl-1">
                                    <div class="column px-0 is-narrow">
                                        <span class="has-text-blue has-text-weight-bold">Bronnen:</span>
                                    </div>
                                    <div class="column content">
                                        <ul class="m-0">
                                            [[for attachment in item.onderbouwing_bronnen:]]
                                            <li><a target="_blank"
                                                   href="[[=attachment.uri]]">[[=attachment.filename]]</a></li>
                                            [[pass]]
                                            [[for link in item.onderbouwing_links:]]
                                            <li><a target="_blank" href="[[=link]]">[[=link]]</a></li>
                                            [[pass]]
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="column is-full">
                    <div class="has-bg-yellow-light" style="border-radius: 1rem; height: 0.75rem"></div>
                </div>
                [[if item.stickers:]]
                <div class="column is-full mb-5">
                    <span class="has-text-blue is-size-5 has-text-weight-bold">Stickers</span>
                    <div class="columns is-multiline m-0">
                        [[for sticker in item.stickers:]]
                        <div class="column is-full">
                            <div class="columns is-mobile">
                                <div class="column is-5">
                                    <object data="[[=sticker.uri]]" style="height: auto; width: 100%; margin: auto;">
                                    </object>
                                </div>
                                <div class="column is-7 has-text-blue content my-auto">
                                    [[=XML(sticker.description_html)]]
                                </div>
                            </div>
                        </div>
                        [[pass]]
                    </div>
                </div>
                <div class="column is-full">
                    <div class="has-bg-yellow-light" style="border-radius: 1rem; height: 0.75rem"></div>
                </div>
                [[pass]]
                <div class="column is-full">
                    <div class="is-flex mb-3"><span class="has-text-blue is-size-5 has-text-weight-bold">Labels</span>
                        <!-- <span
                                 class="icon my-auto ml-1">
                          <object data="[[=URL('static/images/info.svg')]]"
                                  style="height: 1.25rem; width: auto;"></object>
                     </span> -->
                    </div>
                    [[for tag in item.tags:]]
                    [[if not tag.deprecated:]]
                    <a
                            _="on load call search_tag_url('[[=tag.id]]') then set my @href to it"
                            class="tag mr-1 mb-2 has-text-blue has-bg-white"
                            style="font-size: 0.85rem; border-radius: 2px;">[[=tag.name]]</a>
                    [[pass]]
                    [[pass]]
                </div>
            </div>
        </div>
    </div>

</div>
<div id="claim_ownership" class="modal">
    <form class="no-form-trap"
          hx-target="#claim-message-feedback"
          hx-post="claim_ownership"
          _="on ew:success set #claim-message-input's value to ''"
    >
        <input type="hidden" name="who" value="[[=item.author.id]]"/>
        <input type="hidden" name="item" value="[[=item.id]]"/>
        <div class="modal-background"></div>
        <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Deze praktijk is van mijn team</p>
                <button _="install CloseModal" class="delete" aria-label="close" type="button"></button>
            </header>
            <section class="modal-card-body">
                <p>Deze praktijkervaring is nog niet door een team geclaimd. Werk jij in dit team en/of heb jij
                    aanvullende informatie? Laat jouw gegevens achter en een Eddie neemt contact met je op.</p>
                <div class="field is-horizontal pt-5">
                    <div class="field-body">
                        <div class="field">
                            <p class="control is-expanded">
                                <input id="claim-phone-input" name="phone" class="input"
                                       placeholder="Telefoonnummer (optioneel)"/>
                            </p>
                        </div>
                        <div class="field">
                            <p class="control is-expanded">
                                <input required id="claim-email-input" name="email" class="input"
                                       placeholder="Uw e-mail adres" [[if anonymous:]] value="" [[else:]] disabled
                                       value="[[=my_email]]" [[pass]]/>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                        <textarea id="claim-message-input" name="message" class="textarea"
                                  placeholder="Extra bericht voor bij de aanvraag"
                                  rows="10"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <p id="claim-message-feedback" class="help is-success"></p>
            </section>
            <footer class="modal-card-foot">
                <button class="edwh-button-profile"
                        aria-label="Verzend"
                        type="submit">
                    Verzend
                </button>
                <button _="install CloseModal"
                        class="edwh-button is-rounded" type="button" aria-label="Annuleer">
                    Annuleer
                </button>
            </footer>
        </div>
    </form>
</div>

<div id="contactme" class="modal">
    <form class="no-form-trap"
          hx-target="#message-feedback"
          hx-post="contact"
          _="on ew:success set #contact-message-input's value to ''"
    >
        <input type="hidden" name="who" value="[[=item.author.id]]"/>
        <input type="hidden" name="item" value="[[=item.id]]"/>
        <div class="modal-background"></div>
        <div class="modal-card">
            <header class="modal-card-head">
                <p class="modal-card-title">Contact</p>
                <button _="install CloseModal" class="delete" aria-label="close" type="button"></button>
            </header>
            <section class="modal-card-body">
                <label for="contact-message-input">Schrijf een bericht</label>
                <textarea required id="contact-message-input" name="question" class="textarea"
                          placeholder="10 lines of textarea"
                          rows="10"></textarea>
                <p id="message-feedback" class="help is-success"></p>
            </section>
            <footer class="modal-card-foot">
                <button class="edwh-button-profile"
                        aria-label="Verzend"
                        type="submit">
                    Verzend
                </button>
                <button _="install CloseModal"
                        class="edwh-button is-rounded" type="button" aria-label="Annuleer">
                    Annuleer
                </button>
            </footer>
        </div>
    </form>
</div>
<div id="openimage" class="modal">
    <div class="modal-background"></div>
    <div class="modal-content has-text-centered">
        <img id="modal_image" src=""/>
    </div>
    <button class="modal-close delete" data-modal="#openimage" aria-label="close"
            _="install CloseModal"
            type="button"></button>
</div>


<script>
    // Map DOM Element
    const $map = document.getElementById('map')

    function convert_lonlat(lonlat_as_str, reverse = true) {
        // Remove parentheses and split by comma
        const lonlat = lonlat_as_str.replace('(', '').replace(')', '').split(',');

        // Convert strings to numbers and reverse the array
        const as_numbers = lonlat.map(Number).filter(it => !isNaN(it))

        if (as_numbers.length !== 2) {
            throw "Not a (lat, lon) tuple!"
        }

        return reverse ? as_numbers.reverse() : as_numbers;
    }


    function add_point_to_map(lonlat_as_str) {
        // Extract the coordinates of the point
        const lonlat = convert_lonlat(lonlat_as_str)

        if (lonlat && lonlat.length === 2) {
            // Add a marker to the map at the given lonlat
            return L.marker(lonlat).addTo(map);
        } else {
            throw `invalid lonlat ${lonlat}`
        }
    }

    /**
     *
     * @param {String} lonlat_as_str
     * @returns {*}
     */
    function loose_add_point_to_map(lonlat_as_str) {
        try {
            return add_point_to_map(lonlat_as_str)
        } catch (err) {
            // don't crash
            console.warn('could not add point to map', err)
        }
    }

    // 'main':
    const point_lonlat = $map.dataset.lonlat;

    const map_zoom_level_fallback_raw = '[[=request.settings["map_zoom_level_fallback"]]]';
    const map_zoom_level_fallback = Number(map_zoom_level_fallback_raw) || 7; // heel Nederland

    const map_zoom_raw = `[[=request.settings['map_zoom_level']]]`;
    let map_zoom = Number(map_zoom_raw) || 7

    // if there is no location, use map_zoom_level_fallback because there is no city to show -> show whole country
    if (!point_lonlat) {
        map_zoom = map_zoom_level_fallback
    }

    const map_center_fallback_raw = `[[=request.settings['map_center_fallback']]]`;
    const map_center_fallback = convert_lonlat(map_center_fallback_raw, false)


    const map_center_raw = `[[=request.settings['map_center']]]`;

    let map_center = map_center_fallback; // default: Nederland

    if (map_center_raw === "auto" && point_lonlat) {
        map_center = convert_lonlat(point_lonlat)
    } else if (map_center_raw === "average" && point_lonlat) {
        const lonlat = convert_lonlat(point_lonlat)
        map_center = [(lonlat[0] + map_center_fallback[0]) / 2, (lonlat[1] + map_center_fallback[1]) / 2]

    } else {
        try {
            map_center = convert_lonlat(map_center_raw, false);
        } catch {
            console.warn("Could not update map center")
        }
    }

    // Map leaflet instance
    const map = L.map('map').setView(map_center, map_zoom);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
        maxZoom: 20,
    }).addTo(map);
    map.gestureHandling.enable()

    loose_add_point_to_map(point_lonlat)
</script>

<script>
    document.title = "[[=item.name]] - Eddie";
</script>