/*! For license information please see 6874.dcc6bde2898eeb9f88e4.js.LICENSE.txt */
"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[6874,3612,1231,8850,3159,4493],{86874:(e,r,t)=>{t.r(r),t.d(r,{canOpenDrillthroughOnSelection:()=>b,getDrillthroughWidgetFilters:()=>N,pluginMenuItemOpenDrillthrough:()=>S});var n=t(63612),l=t(31529),o=t(93345),a=t(12166),i=t(21900),s=t(11813),u=t(2563),m=t(41958),c=t(66003),d=t(37236),h=t(51728),f=t(60824),g=t(26353),p=t(26771),y=t(60125);function b(e){return void 0!==e&&!(e.axes&&e.axes.length>0)&&void 0!==e.cells&&1===e.cells.length&&void 0!==e.cells[0].value}var _=t(34531),x=t(56093),C=t(64164);function v(e,r){const{dimensionName:t,hierarchyName:n}=e;return r.some((e=>(0,C.q)(e,{dimensionName:t,hierarchyName:n})))}function N({sourceWidgetFilters:e,tuple:r}){return[...(e||[]).filter((e=>!v(e,r))),...r.map((({dimensionName:e,hierarchyName:r,namePath:t})=>({type:"members",dimensionName:e,hierarchyName:r,members:[t]})))]}const S={key:"open-drillthrough",useMenuItem:e=>{const{selection:r,widgetState:t}=e,{cube:C,serverKey:S}=(0,y.useCube)(t),{formatMessage:D}=(0,a.useIntl)(),O=(0,c.g)(),k=(0,o.useMemo)((()=>{if(b(r))return r.cells[0].tuple.filter((e=>"Measures"===e.dimensionName||!(0,s.isTotal)((0,f.q)(e,C),e)))}),[C,r]),F=(0,o.useMemo)((()=>{if(k){const e=k.filter((e=>"Measures"!==e.dimensionName));return D({id:"aui.plugins.menu-item.open-drillthrough.openDrillthrough"},{member:e.length>0?(0,s.getTupleCaption)(e,{captionForTotals:D({id:"aui.total"}),cube:C,separator:", ",hasOnlyCaptionForLeafLevels:!0}):void 0})}}),[D,k,C]),[M]=(0,u.i)("drillthrough.defaultSelectedColumns"),[w]=(0,m.N)(S,C.name),j=(0,o.useMemo)((()=>{const e=(0,p.h)(w??[]);return(0,l.flatten)(["numeric","regular","date"].map((r=>e[r]??[])))}),[w]),q=(0,o.useCallback)((async()=>{if(O&&F&&k&&(0,i.M)(e)){const r=(0,d.z)(e.dashboardState.pagesOrder),n=e.dashboardState.pagesOrder.indexOf(O),o=e.dashboardState.pages[O];if(void 0===t.query.mdx)return;const a=function({name:e,sourceWidget:r,sourceWidgetPage:t,tuple:n,drillthroughColumns:o,defaultSelectedColumns:a,cube:i}){const s=N({sourceWidgetFilters:r.filters,tuple:n}),u=(0,l.map)(o,"name"),m=a[i.name]?(0,l.intersection)(u,a[i.name]):u,c={mdx:(0,_.I)((0,y.getDefaultMdxDrillthrough)(i.name),{drillthroughColumnUniqueNames:m})};r.query.mdx&&r.query.mdx.withClause&&(c.mdx.select.withClause=r.query.mdx.withClause);const d=(t.filters||[]).filter((e=>!v(e,n)));return{name:e,content:{0:{...x._.initialState,query:c,serverKey:r.serverKey,initialCubeName:i.name,filters:s}},layout:{direction:"column",children:[{leafKey:"0",size:1}]},filters:d}}({name:F,sourceWidget:t,sourceWidgetPage:o,tuple:k,drillthroughColumns:j,defaultSelectedColumns:M,cube:C}),i=(0,h.H)(e.dashboardState,{page:a,key:r,index:n+1});e.onDashboardChange(i),e.onActivePageChange(r)}}),[O,C,F,e,k,t,M,j]);if((0,i.M)(e)&&k&&t.query.mdx)return{icon:(0,n.Y)(g.IconDrillthrough,{}),label:F,onClick:q}},translations:{"en-US":{openDrillthrough:"Drillthrough {member, select,\n           undefined {}\n           other {on {member}}\n          }"},"fr-FR":{openDrillthrough:"Drillthrough {member, select,\n           undefined {}\n           other {sur {member}}\n          }"}}}},63612:(e,r,t)=>{t.d(r,{FD:()=>i,FK:()=>o,Y:()=>a});var n=t(63159),l=t(56801),o=(t(93345),t(77619),t(4674),t(19278),t(33525),n.Fragment);function a(e,r,t){return l.h.call(r,"css")?n.jsx(l.E,(0,l.c)(e,r),t):n.jsx(e,r,t)}function i(e,r,t){return l.h.call(r,"css")?n.jsxs(l.E,(0,l.c)(e,r),t):n.jsxs(e,r,t)}},81245:(e,r,t)=>{var n=t(93345),l=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function u(e,r,t){var n,o={},u=null,m=null;for(n in void 0!==t&&(u=""+t),void 0!==r.key&&(u=""+r.key),void 0!==r.ref&&(m=r.ref),r)a.call(r,n)&&!s.hasOwnProperty(n)&&(o[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===o[n]&&(o[n]=r[n]);return{$$typeof:l,type:e,key:u,ref:m,props:o,_owner:i.current}}r.Fragment=o,r.jsx=u,r.jsxs=u},63159:(e,r,t)=>{e.exports=t(81245)}}]);