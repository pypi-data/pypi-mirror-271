/// Files: arch/x86/kvm/x86.c
/// Fix: a08d3b3b99efd509133946056531cdf8f3a0c09b
/// Fixes: f78146b0f9230765c6315b2e14f56112513389ad

virtual detect

@err exists@
identifier vcpu;
position p;
@@

\(complete_mmio\|complete_emulated_mmio\)(struct kvm_vcpu *vcpu)
{
	...
*	if (vcpu->mmio_cur_fragment ==@p vcpu->mmio_nr_fragments) {
		...
		vcpu->mmio_read_completed = 1;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-0049')
