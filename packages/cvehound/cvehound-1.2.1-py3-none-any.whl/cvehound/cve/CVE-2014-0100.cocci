/// Files: net/ipv4/inet_fragment.c
/// Fix: 24b9bf43e93e0edd89072da51cf1fab95fc69dec
/// Fixes: 3ef0eb0db4bf92c6d2510fe5c4dc51852746f206

virtual detect

@err@
identifier nf, f, hb, qp;
position p;
@@

inet_frag_intern(struct netns_frags *nf, ...,
		 struct inet_frags *f, ...)
{
	...
(
*	spin_unlock(&hb->chain_lock);
*	read_unlock(&f->lock);
|
*	write_unlock(&f->lock);
)
*	inet_frag_lru_add@p(nf, qp);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-0100')
