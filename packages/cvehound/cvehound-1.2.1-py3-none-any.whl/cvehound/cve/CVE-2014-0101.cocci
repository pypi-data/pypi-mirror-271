/// Files: net/sctp/sm_statefuns.c
/// Fix: ec0223ec48a90cb605244b45f7c62de856403729
/// Fixes: bbd0d59809f923ea2b540cbd781b32110e249f6e

virtual detect

@err@
identifier net, chunk, auth;
position p;
@@

sctp_sf_do_5_1D_ce(...)
{
	...
	if (chunk->auth_chunk) {
		... when != if (!net->sctp.auth_enable || !new_asoc->peer.auth_capable) { ... return sctp_sf_pdiscard(net, ...); }
*		auth.skb =@p chunk->auth_chunk;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-0101')
