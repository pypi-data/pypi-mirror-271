/// Files: drivers/usb/serial/visor.c
/// Fix: cb3232138e37129e88240a98a1d2aba2187ff57c
/// Fixes: cfb8da8f69b81d367b766888e83ec0483a31bf01

virtual detect

@err@
identifier serial, port;
position p;
@@

clie_5_attach(struct usb_serial *serial)
{
	...
*	if (serial->num_ports < 2)
*		return -1;@p
	...
	usb_sndbulkpipe(serial->dev, port->bulk_out_endpointAddress)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2015-7566')
