/// Files: fs/fuse/file.c
/// Fix: 3ca8138f014a913f98e6ef40e939868e1e9ea876
/// Fixes: ea9b9907b82a09bd1a708004454f7065de77c5b0

virtual detect

@err@
identifier again, ii, tmp;
position p;
@@

fuse_fill_write_pages(..., struct iov_iter *ii, ...)
{
	...
again:
	...
*	tmp = iov_iter_copy_from_user_atomic(..., ii, ...);
	... when != iov_iter_advance(ii, tmp);
	if (!tmp) {
		...
*		goto again;
	}
	...
*	iov_iter_advance@p(ii, tmp);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2015-8785')
