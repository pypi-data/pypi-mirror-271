/// Files: net/netfilter/nf_nat_redirect.c
/// Fix: 94f9cd81436c85d8c3a318ba92e236ede73752fc
/// Fixes: 8b13eddfdf04cbfa561725cfc42d6868fe896f56

virtual detect

@err exists@
identifier skb, indev, newdst, ifa;
position p;
@@

nf_nat_redirect_ipv4(struct sk_buff *skb, ...)
{
	...
	indev = __in_dev_get_rcu(skb->dev);
*	if (indev !=@p NULL) {
		ifa = indev->ifa_list;
		newdst = ifa->ifa_local;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2015-8787')
