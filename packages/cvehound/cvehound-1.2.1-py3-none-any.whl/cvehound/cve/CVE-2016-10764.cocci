/// Files: drivers/mtd/spi-nor/cadence-quadspi.c
/// Fix: 193e87143c290ec16838f5368adc0e0bc94eb931
/// Fixes: 140623410536905fa6ab737b625decfde6c64a72

virtual detect

@err exists@
identifier cqspi, cs;
position p;
@@

cqspi_setup_flash(struct cqspi_st *cqspi, ...)
{
	...
*	if (cs >@p CQSPI_MAX_CHIPSELECT) {
		...
		dev_err(dev, "Chip select %d out of range.\n", cs);
		...
	}
	... when any
*	cqspi->f_pdata[cs]
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-10764')
