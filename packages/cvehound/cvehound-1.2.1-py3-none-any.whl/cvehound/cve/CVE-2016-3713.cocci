/// Files: arch/x86/kvm/mtrr.c arch/x86/include/asm/kvm_host.h
/// Fix: 9842df62004f366b9fed2423e24df10542ee0dc5
/// Fixes: 910a6aae4e2e45855efc4a268e43eed2d8445575

virtual detect

@kvm_mtrr_var_ranges@
symbol var_ranges;
@@

struct kvm_mtrr {
(
*	struct mtrr_var_range var_ranges[KVM_NR_VAR_MTRR];
|
*	struct kvm_mtrr_range var_ranges[KVM_NR_VAR_MTRR];
)
	...
};

@err depends on kvm_mtrr_var_ranges exists@
symbol true;
position p;
@@

msr_mtrr_valid(...)
{
	... when any
	switch(...) {
*	case 0x2f8:@p
*		return true;
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-3713')
