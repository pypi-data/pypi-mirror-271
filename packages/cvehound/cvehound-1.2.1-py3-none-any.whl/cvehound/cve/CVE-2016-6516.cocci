/// Files: fs/ioctl.c
/// Fix: 10eec60ce79187686e052092e5383c99b4420a20
/// Fixes: 54dbc15172375641ef03399e8f911d7165eb90fb

virtual detect

@err exists@
identifier file, same, count;
position p;
@@

ioctl_file_dedupe_range(struct file *file, ...)
{
	...
*	same = memdup_user(...);
	... when != same->dest_count = count;
*	ret = vfs_dedupe_file_range@p(file, same);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-6516')
