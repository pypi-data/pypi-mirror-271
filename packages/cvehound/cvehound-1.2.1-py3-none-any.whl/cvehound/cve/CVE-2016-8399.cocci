/// Files: net/ipv4/ping.c
/// Fix: 0eab121ef8750a5c8637d51534d5e9143fb0633f
/// Fixes: c319b4d76b9e583a5d88d6bf190e079c4e43213d

virtual detect

@err exists@
identifier len, icmph_len;
position p;
@@

\(ping_sendmsg\|ping_common_sendmsg\)(...)
{
	... when != if (len < icmph_len) return -EINVAL;
*	\(memcpy_from_msg@p\|memcpy_fromiovec@p\)(...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-8399')
