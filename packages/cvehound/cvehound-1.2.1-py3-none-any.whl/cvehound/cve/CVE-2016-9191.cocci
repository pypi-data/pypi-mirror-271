/// Files: fs/proc/proc_sysctl.c
/// Fix: 93362fa47fe98b62e4a34ab408c4a418432e7939
/// Fixes: f0c3b5093addc8bfe9fe3a5b01acb7ec7969eafa

virtual detect

@err exists@
identifier file, ctx;
position p;
@@

proc_sys_readdir(struct file *file, struct dir_context *ctx)
{
	...
*	if (!dir_emit_dots(file, ctx))
*		return ...;@p
	...
	sysctl_head_finish(...);
	return 0;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-9191')
