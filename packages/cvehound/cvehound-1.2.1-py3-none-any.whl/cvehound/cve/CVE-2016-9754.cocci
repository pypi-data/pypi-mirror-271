/// Files: kernel/trace/ring_buffer.c
/// Fix: 59643d1535eb220668692a5359de22545af579f6
/// Fixes: 83f40318dab00e3298a1f6d0b12ac025e84e478d

virtual detect

@err@
identifier size, nr_pages;
position p;
@@

ring_buffer_resize(...)
{
	...
	size = DIV_ROUND_UP(size, BUF_PAGE_SIZE);
	size *= BUF_PAGE_SIZE;
	if (size < BUF_PAGE_SIZE * 2)
		size = BUF_PAGE_SIZE * 2;
*	nr_pages =@p DIV_ROUND_UP(size, BUF_PAGE_SIZE);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-9754')
