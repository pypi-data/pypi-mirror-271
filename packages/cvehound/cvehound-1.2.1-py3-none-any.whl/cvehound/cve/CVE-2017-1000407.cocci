/// Files: arch/x86/kvm/vmx.c
/// Fix: d59d51f088014f25c2562de59b9abff4f42a7468
/// Fixes: fdef3ad1b38660d74a29abc990940b5dbaaf3fc9

virtual detect

@err@
expression vmx_io_bitmap_a;
position p;
@@

\(hardware_setup\|vmx_init\)(void)
{
	...
*	clear_bit@p(0x80, vmx_io_bitmap_a);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-1000407')
