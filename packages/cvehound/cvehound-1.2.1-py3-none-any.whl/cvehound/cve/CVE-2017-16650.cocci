/// Files: drivers/net/usb/qmi_wwan.c
/// Fix: 7fd078337201cf7468f53c3d9ef81ff78cb6df3b
/// Fixes: 423ce8caab7ea2b13f4a29ce0839369528aafaeb

virtual detect

@err exists@
identifier cdc_ether, dev;
position p;
@@

qmi_wwan_bind(struct usbnet *dev, ...)
{
	...
	if (cdc_ether@p) {
		dev->hard_mtu = le16_to_cpu(cdc_ether->wMaxSegmentSize);
*		usbnet_get_ethernet_addr(dev, cdc_ether->iMACAddress);
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16650')
