/// Files: kernel/bpf/verifier.c
/// Fix: ea25f914dc164c8d56b36147ecc86bc65f83c469
/// Fixes: f1174f77b50c94eecaa658fdc56fa69b421de4b8

virtual detect

@err exists@
identifier regs, regno;
position p;
@@

check_stack_boundary(..., int regno, ...)
{
	...
*	if (!tnum_is_const@p(regs[regno].var_off)) {
		...
		tnum_strn(..., regs[regno].var_off);
		... when != return -EACCES;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-17857')
