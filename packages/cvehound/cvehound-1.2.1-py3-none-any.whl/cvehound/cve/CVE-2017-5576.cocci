/// Files: drivers/gpu/drm/vc4/vc4_gem.c
/// Fix: 0f2ff82e11c86c05d051cae32b58226392d33bbf
/// Fixes: d5b1a78a772f1e31a94f8babfa964152ec5e9aa5

virtual detect

@err exists@
identifier uniforms_offset, shader_rec_offset, exec_size, temp_size, args;
position p;
@@

vc4_get_bcl(...)
{
	...
*	if (uniforms_offset <@p shader_rec_offset ||
*	    exec_size < uniforms_offset ||
*	    args->shader_rec_count >= (...) ||
*	    temp_size < exec_size) {
		...
		DRM_ERROR("overflow in exec arguments\n");
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-5576')
