/// Files: drivers/usb/serial/omninet.c
/// Fix: 30572418b445d85fcfe6c8fe84c947d2606767d8
/// Fixes: 4a90f09b20f4622dcbff1f0e1e6bae1704f8ad8c

virtual detect

@err@
identifier tty, port, wport;
position p;
@@

omninet_open(struct tty_struct *tty, struct usb_serial_port *port, ...)
{
	...
*	tty_port_tty_set@p(&wport->port, tty);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-8925')
