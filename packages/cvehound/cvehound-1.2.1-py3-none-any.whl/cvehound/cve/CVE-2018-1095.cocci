/// Files: fs/ext4/xattr.c
/// Fix: ce3fd194fcc6fbdc00ce095a852f22df97baa401
/// Fixes: e50e5129f384ae282adebfb561189cdb19b81cee

virtual detect

@err exists@
identifier entry;
position p;
@@

ext4_xattr_check_entries(struct ext4_xattr_entry *entry, ...)
{
	... when any
	while (!IS_LAST_ENTRY(entry)) {
*		if (entry->e_value_size != 0 &&
*		    entry->e_value_inum == 0)@p {
		...
		}
		...
	}
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-1095')
