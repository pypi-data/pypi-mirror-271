/// Files: drivers/vhost/vhost.c
/// Fix: 670ae9caaca467ea1bfd325cb2a5c98ba87f94ad
/// Fixes: 6b1e6cc7855b09a0a9bfa1d9f30172ba366f161c

virtual detect

@err exists@
identifier node;
position p;
@@

vhost_new_msg(...)
{
	...
*	struct vhost_msg_node *node = kmalloc@p(...);
	... when != memset(&node->msg, 0, ...);
*	return node;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-1118')
