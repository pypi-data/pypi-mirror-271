/// Files: fs/ext4/inline.c fs/ext4/ext4.h fs/ext4/xattr.h
/// Fix: 117166efb1ee8f13c38f9e96b258f16d4923f888
/// Fixes: e50e5129f384ae282adebfb561189cdb19b81cee

virtual detect

@ext4_xattr_ino_array@
@@

* struct \(ext4_xattr_ino_array\|ext4_xattr_inode_array\) { ... };

@err depends on ext4_xattr_ino_array exists@
identifier is, inode;
position p;
@@

ext4_find_inline_data_nolock(struct inode *inode)
{
	...
	if (!is.s.not_found) {
		... when != if (is.s.here->e_value_inum) { ... }
*		EXT4_I(inode)->i_inline_off =@p ...;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-11412')
