/// Files: kernel/time/alarmtimer.c
/// Fix: 5f936e19cc0ef97dbe3a56e9498922ad5ba1edef
/// Fixes: 9a7adcf5c6dea63d2e47e6f6d2f7a6c9f48b9337
/// Version: 1.1.0

virtual detect

@err exists@
identifier flags, type, now, exp;
position p;
@@

alarm_timer_nsleep(..., int flags, ...)
{
	...
	if (flags != TIMER_ABSTIME) {
		ktime_t now = alarm_bases[type].gettime();
		exp = ktime_add@p(now, exp);
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-13053')
