/// Files: drivers/video/fbdev/uvesafb.c
/// Fix: 9f645bcc566a1e9f921bdae7528a01ced5bc3713
/// Fixes: 8bdb3a2d7df48b861972c4bfb58490853a228f51

virtual detect

@err exists@
identifier entries, cmap;
position p;
@@

uvesafb_setcmap(struct fb_cmap *cmap, ...)
{
	...
	struct uvesafb_pal_entry *entries;
	...
*	kmalloc(sizeof(*entries) *@p cmap->len, ...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-13406')
