/// Files: crypto/algif_aead.c
/// Fix: b32a7dc8aef1882fbf983eb354837488cc9d54dc
/// Fixes: 72548b093ee38a6d4f2a19e6ef1948ae05c181f7

virtual detect

@err@
identifier sk, ctx;
position p;
@@

aead_sock_destruct(struct sock *sk)
{
	...
	\(aead_pull_tsgl\|af_alg_pull_tsgl\)(sk, ctx->used, NULL, 0);
*	crypto_put_default_null_skcipher2@p();
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-14619')
