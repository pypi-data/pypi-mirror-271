/// Files: sound/usb/card.c
/// Fix: 5f8cf712582617d523120df67d392059eaf2fc4b
/// Fixes: 362e4e49abe53e89d87455dfcd7c1bbaf08a839d

virtual detect

@err@
identifier chip;
position p;
@@

\(snd_usb_audio_probe\|usb_audio_probe\)(...)
{
	...
(
	if (chip) {
		if (!chip->num_interfaces)
			snd_card_free(chip->card);
(
*		atomic_dec@p(&chip->active);
|
*		chip->probing =@p 0;
)
	}
|
	if (chip && !chip->num_interfaces)
		snd_card_free(chip->card);
*	chip->probing =@p 0;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-19824')
