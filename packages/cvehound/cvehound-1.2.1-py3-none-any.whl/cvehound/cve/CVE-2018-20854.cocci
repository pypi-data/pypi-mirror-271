/// Files: drivers/phy/mscc/phy-ocelot-serdes.c
/// Fix: 6acb47d1a318e5b3b7115354ebc4ea060c59d3a1
/// Fixes: 51f6b410fc220d8a5a4fae00ebfd8243b6c11d4e

virtual detect

@err_serdes_simple_xlate@
identifier i;
statement S;
position p;
@@

serdes_simple_xlate(...)
{
	...
*	for (i = 0; i <=@p SERDES_MAX; i++)
		S
	...
}

@err_serdes_probe@
identifier i;
statement S;
position p;
@@

serdes_probe(...)
{
	...
*	for (i = 0; i <=@p SERDES_MAX; i++)
		S
	...
}

@script:python depends on detect@
p << err_serdes_simple_xlate.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-20854')

@script:python depends on detect@
p << err_serdes_probe.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-20854')
