/// Files: drivers/net/wireless/mac80211_hwsim.c
/// Fix: 0ddcff49b672239dda94d70d0fcf50317a9f4b51
/// Fixes: ff4dd73dd2b4806419f8ff65cbce11d5019548d0

virtual detect

@err exists@
identifier info, hwname, idx, hwsim_world_regdom_custom;
position p;
@@

hwsim_new_radio_nl(..., struct genl_info *info)
{
	...
*	hwname = kasprintf(...);
	...
	if (info->attrs[HWSIM_ATTR_REG_CUSTOM_REG]) {
		u32 idx = nla_get_u32(info->attrs[HWSIM_ATTR_REG_CUSTOM_REG]);

		if (idx >= ARRAY_SIZE(hwsim_world_regdom_custom))
*			return -EINVAL;@p
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-8087')
