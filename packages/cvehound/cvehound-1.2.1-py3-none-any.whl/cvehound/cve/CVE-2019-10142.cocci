/// Files: drivers/virt/fsl_hypervisor.c
/// Fix: 6a024330650e24556b8a18cc654ad00cfecf6c6c
/// Fixes: 6db7199407ca56f55bc0832fb124e1ad216ea57b

virtual detect

@err exists@
identifier param, lb_offset;
position p;
@@

ioctl_memcpy(...)
{
	... when != if (param.count == 0 || param.count > U64_MAX - lb_offset - PAGE_SIZE + 1) return -EINVAL;
	param.count@p + lb_offset + PAGE_SIZE - 1
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-10142')
