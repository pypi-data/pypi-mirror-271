/// Files: kernel/ptrace.c
/// Fix: 6994eefb0053799d2e07cd140df6c2ea106c41ee
/// Fixes: 64b875f7ac8a5d60a4e191479299e931ee949b67

virtual detect

@err exists@
identifier child, new_parent;
position p;
@@

\(ptrace_link\|__ptrace_link\)(struct task_struct *child, struct task_struct *new_parent)
{
	...
*	rcu_read_lock();
(
*	__ptrace_link@p(child, new_parent, __task_cred(new_parent));
|
*	child->ptracer_cred =@p get_cred(__task_cred(new_parent));
)
*	rcu_read_unlock();
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-13272')
