/// Files: drivers/vhost/vhost.c
/// Fix: 060423bfdee3f8bc6e2c1bac97de24d5415e2bc4
/// Fixes: 3a4d5c94e959359ece6d6b55045c3f046677f55c

virtual detect

@err_get_indirect@
identifier log, log_num, in_num, ret;
position p;
@@

get_indirect(...,
	     unsigned int *in_num, struct vhost_log *log,
	     unsigned int *log_num, ...)
{
	...
	*in_num += ret;
*	if (unlikely(log@p)) {
		log[*log_num].addr = ...;
		...
	}
	...
}

@err_vhost_get_vq_desc@
identifier log, log_num, in_num, ret;
position p;
@@

vhost_get_vq_desc(...,
		  unsigned int *in_num, struct vhost_log *log,
		  unsigned int *log_num)
{
	...
	*in_num += ret;
*	if (unlikely(log@p)) {
		log[*log_num].addr = ...;
		...
	}
	...
}

@script:python depends on detect@
p << err_get_indirect.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-14835')

@script:python depends on detect@
p << err_vhost_get_vq_desc.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-14835')
