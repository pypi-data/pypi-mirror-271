/// Files: drivers/media/usb/cpia2/cpia2_usb.c
/// Fix: eff73de2b1600ad8230692f00bc0ab49b166512a
/// Fixes: 6c493f8b28c6744995e92801a20dca192635dd22

virtual detect

@err@
identifier cam;
position p;
@@

cpia2_usb_disconnect(...)
{
	...
*	v4l2_device_put@p(&cam->v4l2_dev);
	...
*	wake_up_interruptible(&cam->wq_stream);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15215')
