/// Files: drivers/scsi/libsas/sas_expander.c
/// Fix: 3b0541791453fbe7f42867e310e0c9eb6295364d
/// Fixes: 2908d778ab3e244900c310974e1fc1c69066e450

virtual detect

@err exists@
identifier parent, phy_id, child, phy, res;
position p;
@@

sas_ex_discover_expander(struct domain_device *parent, int phy_id)
{
	...
*	phy->port = sas_port_alloc(&parent->rphy->dev, phy_id);
	...
*	res = sas_discover_expander(child);
	if (res) {
		... when != sas_port_delete(phy->port);
                    when != phy->port = NULL;
*		return NULL;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15807')
