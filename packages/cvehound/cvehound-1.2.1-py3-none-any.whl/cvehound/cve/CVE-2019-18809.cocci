/// Files: drivers/media/usb/dvb-usb/af9005.c
/// Fix: 2289adbfa559050d2a38bcd9caac1c18b800e928
/// Detect-To: c58b84ee467bfd08b39fbda56757ba19ac50980a
/// Version: 1.1.0

virtual detect

@err@
identifier buf, reply, err;
position p;
statement S;
@@

af9005_identify_state(...)
{
	...
*	buf = kmalloc(...);
	...
	if (reply == 0x02)
		S
	else
*		return -EIO;@p
	...
err:
	kfree(buf);
	return ...;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-18809')
