/// Files: drivers/net/wimax/i2400m/op-rfkill.c
/// Fix: 6f3ef5c25cc762687a7341c18cbea5af54461407
/// Detect-To: 024f7f31ed15c471f80408d8b5045497e27e1135
/// Version: 1.1.0

virtual detect

@err_missing_free@
identifier cmd, error_alloc;
position p;
@@

i2400m_op_rfkill_sw_toggle(...)
{
	...
*	cmd = kzalloc(...);
	...
error_alloc:
	... when != kfree(cmd);
	return result;@p
}

@err_wrong_free@
identifier cmd, error_alloc, ack_skb;
position p;
@@

i2400m_op_rfkill_sw_toggle(...)
{
	...
*	cmd = kzalloc(...);
	...
error_cmd:
*	kfree@p(cmd);
	kfree_skb(ack_skb);
	...
}

@script:python depends on detect@
p << err_missing_free.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19051')

@script:python depends on detect@
p << err_wrong_free.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19051')
