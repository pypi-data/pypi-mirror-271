/// Files: drivers/net/wireless/marvell/mwifiex/pcie.c
/// Fix: db8fd2cde93227e566a412cf53173ffa227998bc
/// Fixes: fc3314609047daf472b3ffc49f9a1c5608068713

virtual detect

@err@
identifier adapter, skb;
position p;
@@

mwifiex_pcie_alloc_cmdrsp_buf(struct mwifiex_adapter *adapter)
{
	...
*	skb = dev_alloc_skb(MWIFIEX_UPLD_SIZE);
	...
*	if (mwifiex_map_pci_memory(adapter, skb, MWIFIEX_UPLD_SIZE,
*				   PCI_DMA_FROMDEVICE))
*		return -1;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19056')
