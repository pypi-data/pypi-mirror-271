/// Files: drivers/net/can/usb/peak_usb/pcan_usb_fd.c
/// Fix: 30a8beeb3042f49d0537b7050fd21b490166a3d9
/// Fixes: 0a25e1f4f18566b750ebd3ae995af64e23111e63

virtual detect

@err exists@
identifier dev, pdev;
position p;
@@

pcan_usb_fd_init(struct peak_usb_device *dev)
{
	...
*	pdev->cmd_buffer_addr = kmalloc@p(PCAN_UFD_CMD_BUFFER_SIZE, GFP_KERNEL);
	...
	pcan_usb_fd_drv_loaded(dev, ...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19535')
