/// Files: fs/locks.c
/// Fix: 6d390e4b5d48ec03bb87e63cf0a2bff5f4e116da
/// Fixes: 16306a61d3b7c433c7a127ec6224867b88ece687

virtual detect

@err exists@
identifier waiter;
position p;
@@

locks_delete_block(struct file_lock *waiter)
{
	...
*	if (waiter->fl_blocker == NULL &&
*	    list_empty(&waiter->fl_blocked_requests))
*		return ...;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19769')
