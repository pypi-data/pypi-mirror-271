/// Files: drivers/media/pci/tw5864/tw5864-video.c
/// Fix: 2e7682ebfc750177a4944eeb56e97a3f05734528
/// Fixes: 34d1324edd3154105b7a3985c6c4384d602f2ab6

virtual detect

@err@
identifier v4l2_buf, vb;
position p;
@@

tw5864_handle_frame(...)
{
	...
*	v4l2_buf =@p to_vb2_v4l2_buffer(&vb->vb.vb2_buf);
	... when != vb
*	if (!vb) {
		...
		return;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-20806')
