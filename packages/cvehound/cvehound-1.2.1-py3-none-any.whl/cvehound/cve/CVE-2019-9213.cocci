/// Files: mm/mmap.c
/// Fix: 0a1d52994d440e21def1c2174932410b4f2a98a1
/// Fixes: 8869477a49c3e99def1fcdadd6bbc407fea14b45

virtual detect

@err exists@
identifier address, error;
position p;
@@

expand_downwards(..., unsigned long address)
{
	...
*	error = \(security_mmap_addr@p\|security_file_mmap@p\)(..., address, ...);
*	if (error)
*		return error;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-9213')
