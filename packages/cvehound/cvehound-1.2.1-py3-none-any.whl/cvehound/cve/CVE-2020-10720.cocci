/// Files: net/core/dev.c
/// Fix: a4270d6795b0580287453ea55974d948393e66ef
/// Fixes: a50e233c50dbc881abaa0e4070789064e8d12d70
/// Version: 1.1.0

virtual detect

@err@
identifier eth, skb;
position p;
@@

napi_frags_skb(...)
{
	...
*	eth =@p skb_gro_header_fast(skb, ...);
	if (unlikely(skb_gro_header_hard(skb, ...))) {
 		eth = skb_gro_header_slow(skb, ...);
		...
	} else {
		... when != eth = (const struct ethhdr *)skb->data;
	}
	... when any
*	eth
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-10720')
