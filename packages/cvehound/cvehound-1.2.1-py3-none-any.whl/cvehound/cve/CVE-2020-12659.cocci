/// Files: net/xdp/xdp_umem.c
/// Fix: 99e3a236dd43d06c65af0a2ef9cb44306aef6e02
/// Fixes: c0c77d8fb787cfe0c3fca689c2a30d1dad4eaba7

virtual detect

@err exists@
identifier umem, size_chk, chunk_size, headroom;
position p;
@@

xdp_umem_reg(struct xdp_umem *umem, ...)
{
	...
*	size_chk =@p chunk_size - headroom - XDP_PACKET_HEADROOM;
	... when != size_chk
	    when != chunk_size
	    when != headroom
*	if (size_chk < 0)
*		return -EINVAL;
	...
	umem->address = ...;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-12659')
