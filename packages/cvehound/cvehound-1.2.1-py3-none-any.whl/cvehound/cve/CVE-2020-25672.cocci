/// Files: net/nfc/llcp_sock.c net/nfc/llcp/sock.c
/// Fix: 7574fcdbdcb335763b6b322f6928dc0fd5730451
/// Fixes: d646960f7986fefb460a2b062d5ccc8ccfeacc3a

virtual detect

@err@
identifier llcp_sock, err_label;
position p;
@@

llcp_sock_connect(...)
{
	...
*	llcp_sock->service_name =@p kmemdup(...);
	...
	nfc_llcp_send_connect(llcp_sock)
	...
err_label:
	... when != kfree(llcp_sock->service_name);
	    when any
	release_sock(...);
	return ...;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25672')
