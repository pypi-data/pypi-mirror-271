/// Files: net/bluetooth/hci_event.c
/// Fix: 51c19bf3d5cfaa66571e4b88ba2a6f6295311101
/// Detect-To: 21d9e30ed020d24336cc3bee2a4e04da232ed554

virtual detect

@err exists@
identifier hdev, skb;
expression E;
position p;
@@

hci_extended_inquiry_result_evt(struct hci_dev *hdev, struct sk_buff *skb)
{
	... when != skb->len < E
*	hci_dev_lock@p(hdev);
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-36386')
