/// Files: drivers/block/floppy.c
/// Fix: a0c80efe5956ccce9fe7ae5c78542578c07bc20a
/// Detect-To: v2.6.12-rc2

virtual detect

@err_floppy_revalidate exists@
position p;
@@

floppy_revalidate(...)
{
	...
*	lock_fdc@p(...);
	...
}

@err_floppy_check_events exists@
position p;
@@

floppy_check_events(...)
{
	...
*	lock_fdc@p(...);
	...
}

@script:python depends on detect@
p << err_floppy_revalidate.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-20261')

@script:python depends on detect@
p << err_floppy_check_events.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-20261')
