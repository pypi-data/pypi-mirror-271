/// Files: drivers/net/xen-netback/interface.c
/// Fix: 107866a8eb0b664675a260f1ba0655010fac1e08
/// Fixes: 2ac061ce97f413bfbbdd768f7d2e0fda2e8170df

virtual detect

@err_xenvif_disconnect_queue exists@
identifier queue;
position p;
@@

xenvif_disconnect_queue(struct xenvif_queue *queue)
{
	...
	if (queue->task) {
*		kthread_stop@p(queue->task);
		queue->task = NULL;
	}
	...
}

@err_xenvif_connect_data exists@
identifier queue;
position p;
@@

xenvif_connect_data(struct xenvif_queue *queue, ...)
{
	...
*	queue->task =@p task;
	task = kthread_run(...);
	...
}

@script:python depends on detect@
p << err_xenvif_disconnect_queue.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-28691')

@script:python depends on detect@
p << err_xenvif_connect_data.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-28691')
