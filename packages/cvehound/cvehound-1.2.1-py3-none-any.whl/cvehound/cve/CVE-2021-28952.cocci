/// Files: sound/soc/qcom/sdm845.c
/// Fix: 1c668e1c0a0f74472469cd514f40c9012b324c31
/// Fixes: 1b93a88431470ea0b943157999084d9c7e6e3bd3

virtual detect

@err_stream_prepared exists@
position p;
@@

struct sdm845_snd_data {
	...
*	bool stream_prepared@p[SLIM_MAX_RX_PORTS];
	...
};

@err_sruntime exists@
position p;
@@

struct sdm845_snd_data {
	...
*	struct sdw_stream_runtime *sruntime@p[SLIM_MAX_RX_PORTS];
	...
};

@script:python depends on detect@
p << err_stream_prepared.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-28952')

@script:python depends on detect@
p << err_sruntime.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-28952')
