/// Files: arch/x86/kvm/vmx/vmx.c
/// Fix: 04c4f2ee3f68c9a4bf1653d15f1a9a435ae33f7a
/// Fixes: 1aa561b1a4c0ae2a9a9b9c21a84b5ca66b4775d8

virtual detect

@err exists@
identifier vcpu;
position p;
@@

\(__vmx_handle_exit\|vmx_handle_exit\)(struct kvm_vcpu *vcpu, ...)
{
	...
*	vcpu->run->internal.data[vcpu->run->internal.ndata@p++]
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3501')
