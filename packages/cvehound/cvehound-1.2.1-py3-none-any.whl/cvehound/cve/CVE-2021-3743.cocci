/// Files: net/qrtr/qrtr.c
/// Fix: 7e78c597c3ebfd0cb329aa09a838734147e4f117
/// Fixes: 194ccc88297ae78d0803adad83c6dcc369787c9e

virtual detect

@err_type exists@
identifier size, hdrlen, len;
position p;
@@

qrtr_endpoint_post(..., size_t len)
{
	...
*	unsigned int size;@p
	...
*	ALIGN(size, 4)
	...
}

@err_zero exists@
identifier size, hdrlen, len;
statement S;
position p;
@@

qrtr_endpoint_post(..., size_t len)
{
	...
*	if (len !=@p ALIGN(size, 4) + hdrlen)
		S
	...
}

@script:python depends on detect@
p << err_type.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3743')

@script:python depends on detect@
p << err_zero.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3743')
