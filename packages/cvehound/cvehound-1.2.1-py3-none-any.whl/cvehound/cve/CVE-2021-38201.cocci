/// Files: net/sunrpc/xdr.c
/// Fix: 6d1c0f3d28f98ea2736128ed3e46821496dc3a8c
/// Fixes: 8d86e373b0ef52d091ced9583ffbb33ad2771576

virtual detect

@err exists@
identifier maxlen, xdr, base;
statement S;
position p;
@@

xdr_set_page_base(struct xdr_stream *xdr, unsigned int base, ...)
{
	...
	maxlen = xdr->buf->page_len;
	if (base >= maxlen) {
*		base = maxlen;
*		maxlen =@p 0;
	} else S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-38201')
