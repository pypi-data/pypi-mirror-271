/// Files: drivers/net/ethernet/xilinx/xilinx_emaclite.c drivers/net/xilinx_emaclite.c
/// Fix: d0d62baa7f505bd4c59cd169692ff07ec49dde37
/// Detect-To: bb81b2ddfa194b6d12761a350b5b5985cecae0a9

virtual detect

@err exists@
identifier dev;
position p;
@@

xemaclite_of_probe(...)
{
	...
*	dev_info@p(dev,
(
*		"Xilinx EmacLite at 0x%08lX mapped to 0x%08lX, irq=%d\n"
|
*		"Xilinx EmacLite at 0x%08X mapped to 0x%08lX, irq=%d\n"
|
*		"Xilinx EmacLite at 0x%08X mapped to 0x%08X, irq=%d\n"
),
		...
	);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-38205')
