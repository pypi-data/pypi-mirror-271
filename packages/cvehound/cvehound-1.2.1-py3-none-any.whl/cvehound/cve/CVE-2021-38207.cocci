/// Files: drivers/net/ethernet/xilinx/ll_temac_main.c
/// Fix: c364df2489b8ef2f5e3159b1dff1ff1fdb16040d
/// Fixes: 84823ff80f7403752b59e00bb198724100dc611c

virtual detect

@err exists@
identifier lp, num_frag;
position p;
@@

temac_start_xmit(...)
{
	...
*	if (temac_check_tx_bd_space@p(lp, num_frag))
*		return ...;
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-38207')
