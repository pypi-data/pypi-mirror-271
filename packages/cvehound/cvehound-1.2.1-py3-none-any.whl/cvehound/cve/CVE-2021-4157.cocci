/// Files: fs/nfs/flexfilelayout/flexfilelayout.c
/// Fix: ed34695e15aba74f45247f1ee2cf7e09d449f925
/// Fixes: d67ae825a59d639e4d8b82413af84d854617a87e

virtual detect

@err@
identifier fh;
statement S;
position p;
@@

decode_nfs_fh(..., struct nfs_fh *fh)
{
	...
	fh->size = be32_to_cpup(...);
*	if (fh->size > sizeof@p(struct nfs_fh))
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-4157')
