/// Files: drivers/net/hamradio/6pack.c
/// Fix: 19d1532a187669ce86d5a2696eb7275310070793
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier sp;
position p;
@@

decode_data(struct sixpack *sp, ...)
{
	... when != sp->rx_count_cooked + 2 >= sizeof(sp->cooked_buf)
*	sp->cooked_buf@p[sp->rx_count_cooked++]
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-42008')
