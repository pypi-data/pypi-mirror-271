/// Files: drivers/soc/aspeed/aspeed-lpc-ctrl.c drivers/misc/aspeed-lpc-ctrl.c
/// Fix: b49a0e69a7b1a68c8d3f64097d06dabb770fec96
/// Fixes: 6c4e976785011dfbe461821d0bfc58cfd60eac56

virtual detect

@err exists@
identifier vma, vsize, lpc_ctrl;
position p;
@@

aspeed_lpc_ctrl_mmap(..., struct vm_area_struct *vma)
{
	...
*	if (vma->vm_pgoff + vsize >@p lpc_ctrl->mem_base + lpc_ctrl->mem_size)
*		return -EINVAL;
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-42252')
