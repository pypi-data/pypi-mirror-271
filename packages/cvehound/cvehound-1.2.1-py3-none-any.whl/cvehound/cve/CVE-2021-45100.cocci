/// Files: fs/ksmbd/smb2ops.c fs/ksmbd/smb2pdu.c
/// Fix: 83912d6d55be10d65b5268d1871168b9ebe1ec4b
/// Fixes: e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9

virtual detect

@err@
identifier conn;
position p;
@@

init_smb3_11_server(struct ksmbd_conn *conn)
{
	...
*	if (conn->cipher_type)
*		conn->vals->capabilities |=@p SMB2_GLOBAL_CAP_ENCRYPTION;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-45100')
