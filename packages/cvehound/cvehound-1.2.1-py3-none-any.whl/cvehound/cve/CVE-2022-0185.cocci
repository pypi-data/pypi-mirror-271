/// Files: fs/fs_context.c
/// Fix: 722d94847de29310e8aa03fcbdb41fc92c521756
/// Detect-To: 3e1aeb00e6d132efc151dacc062b38269bc9eccc

virtual detect

@err@
identifier len, size, fc;
position p;
@@

legacy_parse_param(struct fs_context *fc, ...)
{
	...
*	if (len >@p PAGE_SIZE - 2 - size)
		return invalf(fc, "VFS: Legacy: Cumulative options too large");
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0185')
