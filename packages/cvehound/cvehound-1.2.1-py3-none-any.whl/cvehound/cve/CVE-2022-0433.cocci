/// Files: kernel/bpf/bloom_filter.c
/// Fix: 3ccdcee28415c4226de05438b4d89eb5514edf73
/// Fixes: 9330986c03006ab1d33d243b7cfe598a7a3c1baa
/// Version: 1.0.7

virtual detect

@fix@
symbol bloom_filter_map_ops;
identifier bloom_map_get_next_key;
@@

struct bpf_map_ops bloom_filter_map_ops = {
	...,
	.map_get_next_key = bloom_map_get_next_key,
	...
};

@err depends on !fix@
symbol bloom_filter_map_ops;
position p;
@@

struct bpf_map_ops bloom_filter_map_ops =@p {
	...
};

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0433')
