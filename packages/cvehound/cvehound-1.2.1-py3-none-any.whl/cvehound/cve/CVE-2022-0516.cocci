/// Files: arch/s390/kvm/kvm-s390.c
/// Fix: 2c212e1baedcd782b2535a3f86bc491977677c0e
/// Fixes: 19e1227768863a1469797c13ef8fea1af7beac2c

virtual detect

@err@
identifier vcpu, mop;
position p;
@@

kvm_s390_guest_sida_op(struct kvm_vcpu *vcpu, struct kvm_s390_mem_op *mop)
{
	... when != if (!kvm_s390_pv_cpu_is_protected(vcpu)) return -EINVAL;
	    when any
*	\(copy_to_user@p\|copy_from_user@p\)(...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0516')
