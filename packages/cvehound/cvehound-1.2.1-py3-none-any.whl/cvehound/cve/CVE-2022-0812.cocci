/// Files: net/sunrpc/xprtrdma/rpc_rdma.c
/// Fix: 912288442cb2f431bf3c8cb097a5de83bc6dbac1
/// Fixes: 302d3deb20682a076e1ab551821cacfdc81c5e4f

virtual detect

@err_rpcrdma_max_call_header_size@
identifier maxsegs, size;
position p;
@@

rpcrdma_max_call_header_size(unsigned int maxsegs)
{
	...
*	size = RPCRDMA_HDRLEN_MIN;
	...
*	size =@p maxsegs * ...;
	...
}

@err_rpcrdma_max_reply_header_size@
identifier size;
typedef __be32;
position p;
@@

rpcrdma_max_reply_header_size(unsigned int maxsegs)
{
	...
*	size = RPCRDMA_HDRLEN_MIN;
	...
*	size =@p sizeof(__be32);;
	...
}

@script:python depends on detect@
p << err_rpcrdma_max_call_header_size.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0812')

@script:python depends on detect@
p << err_rpcrdma_max_call_header_size.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0812')
