/// Files: drivers/nfc/nfcmrvl/main.c
/// Fix: d270453a0d9ec10bb8a802a142fb1b3601a83098
/// Fixes: 3194c6870158e305dac2af52f83681e9cb67280f

virtual detect

@err@
identifier priv, ndev;
position p;
@@

nfcmrvl_nci_unregister_dev(struct nfcmrvl_private *priv)
{
	...
	struct nci_dev *ndev = priv->ndev;
	...
*	nfcmrvl_fw_dnld_abort(priv);
	...
*	nci_unregister_device@p(ndev);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-1734')
