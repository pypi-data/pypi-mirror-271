/// Files: net/nfc/netlink.c
/// Fix: 4071bf121d59944d5cd2238de0642f3d7995a997
/// Fixes: 9674da8759df0d6c0d24e1ede6e2a1acdef91e3c

virtual detect

@err@
position p;
@@

\(nfc_genl_fw_upload_done\|nfc_genl_fw_download_done\)(...)
{
	... when any
(
*	nlmsg_new@p(..., GFP_KERNEL)
|
*	genlmsg_multicast@p(..., GFP_KERNEL)
)
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-1975')
