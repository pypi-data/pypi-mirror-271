/// Files: arch/arm64/kernel/armv8_deprecated.c
/// Fix: af483947d472eccb79e42059276c4deed76f99a6
/// Detect-To: 587064b610c703f259317d00dc37bf6d40f4fc74

virtual detect

@err@
identifier table, insn;
position p;
@@

emulation_proc_handler(struct ctl_table *table, ...)
{
	...
*	table->data =@p &insn->current_mode;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-20422')
