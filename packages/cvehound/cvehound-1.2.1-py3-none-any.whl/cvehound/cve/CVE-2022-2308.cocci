/// Files: drivers/vdpa/vdpa_user/vduse_dev.c
/// Fix: 46f8a29272e51b6df7393d58fc5cb8967397ef2b
/// Fixes: c8a6153b6c59d95c0e091f053f6f180952ade91e

virtual detect

@err@
identifier vdpa, offset, buf, len;
position p;
@@

vduse_vdpa_get_config(struct vdpa_device *vdpa, unsigned int offset,
		      void *buf, unsigned int len)
{
	... when != memset(buf, 0, len);
*	memcpy@p(buf, dev->config + offset, len);
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-2308')
