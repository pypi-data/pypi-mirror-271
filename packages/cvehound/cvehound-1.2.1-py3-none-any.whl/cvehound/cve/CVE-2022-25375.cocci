/// Files: drivers/usb/gadget/function/rndis.c drivers/usb/gadget/rndis.c
/// Fix: 38ea1eac7d88072bbffb630e2b3db83ca649b826
/// Detect-To: v2.6.12-rc2

virtual detect

@err@
identifier BufLength, BufOffset;
typedef rndis_set_cmplt_type;
position p;
@@

rndis_set_response(...)
{
	... when != if ((BufLength > RNDIS_MAX_TOTAL_SIZE) || ... || (BufOffset + 8 >= RNDIS_MAX_TOTAL_SIZE)) return -EINVAL;
*	rndis_add_response@p(..., sizeof(rndis_set_cmplt_type))
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-25375')
