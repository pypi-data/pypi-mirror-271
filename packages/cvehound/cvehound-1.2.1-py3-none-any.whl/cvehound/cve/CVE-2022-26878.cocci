/// Files: drivers/bluetooth/virtio_bt.c
/// Fix: 1d0688421449718c6c5f46e458a378c9b530ba18
/// Fixes: afd2daa26c7abd734d78bd274fc6c59a15e61063
/// Version: 1.1.0

virtual detect

@fix@
identifier skb, pkt_type;
@@

virtbt_rx_handle(..., struct sk_buff *skb)
{
	...
	switch (pkt_type) {
	default:
		kfree_skb(skb);
		break;
	}
	...
}

@err depends on !fix@
identifier skb, pkt_type;
position p;
@@

virtbt_rx_handle(..., struct sk_buff *skb)
{
	...
*	switch (pkt_type@p) {
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-26878')
