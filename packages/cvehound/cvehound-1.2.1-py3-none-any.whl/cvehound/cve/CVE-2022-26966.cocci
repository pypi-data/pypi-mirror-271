/// Files: drivers/net/usb/sr9700.c
/// Fix: e9da0b56fe27206b49f39805f7dcda8a89379062
/// Detect-To: c9b37458e95629b1d1171457afdcc1bf1eb7881d

virtual detect

@err@
identifier dev, skb;
position p;
@@

sr9700_rx_fixup(struct usbnet *dev, struct sk_buff *skb)
{
	...
*	if (len > ETH_FRAME_LEN@p)
*		return 0;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-26966')
