/// Files: drivers/video/fbdev/i740fb.c drivers/video/i740fb.c
/// Fix: 40bf722f8064f50200b8c4f8946cd625b441dda9
/// Detect-To: 5350c65f4f15bbc111ffa629130d3f32cdd4ccf6

virtual detect

@err_i740fb_decode_var@
identifier var, par;
position p;
@@

i740fb_decode_var(struct fb_var_screeninfo *var,
		  struct i740fb_par *par, ...)
{
	...
*	i740_calc_vclk@p((... / var->pixclock) * ..., par);
	...
}

@err_i740fb_check_var@
identifier var;
position p;
@@

i740fb_check_var(struct fb_var_screeninfo *var, ...)
{
	... when != if (!var->pixclock) return -EINVAL;
	return 0;@p
}

@script:python depends on detect@
p << err_i740fb_decode_var.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-3061')

@script:python depends on detect@
p << err_i740fb_check_var.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-3061')
