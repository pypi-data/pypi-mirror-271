/// Files: sound/core/control.c
/// Fix: 5934d9a0383619c14df91af8fd76261dc3de2f5f
/// Fixes: c27e1efb61c545f36c450ef60862df9251d239a4

virtual detect

@err@
identifier id, p, h, MULTIPLIER, i;
position r;
@@

get_ctl_id_hash(struct snd_ctl_elem_id *id)
{
	...
(
*	for (p = id@r->name; *p; p++)
*		h = MULTIPLIER * h + *p;
|
*	for (i = 0; id@r->name[i] && i < SNDRV_CTL_ELEM_ID_NAME_MAXLEN; i++)
*		h = MULTIPLIER * h + id->name[i];
)
	...
}

@script:python depends on detect@
r << err.r;
@@

coccilib.report.print_report(r[0], 'ERROR: CVE-2022-3170')
