/// Files: net/kcm/kcmsock.c
/// Fix: ec7eede369fe5b0d085ac51fdbb95184f87bfc6c
/// Fixes: ab7ac4eb9832e32a09f4e8042705484d2fb0aad3

virtual detect

@err@
identifier mux, kcm, sk;
position p;
@@

kcm_release(...)
{
	...
	mux = kcm->mux;
	sock_orphan(sk);
	kfree_skb(kcm->seq_skb);
*	lock_sock@p(sk);
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-3521')
