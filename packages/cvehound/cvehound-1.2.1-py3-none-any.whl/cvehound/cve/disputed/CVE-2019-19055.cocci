/// Files: net/wireless/nl80211.c
/// Fix: 1399c59fa92984836db90538cf92397fe7caaa57
/// Fixes: 81e54d08d9d845053111f30045a93f3eb1c3ca96
/// Version: 1.1.0

virtual detect

@err exists@
identifier msg, hdr, nla_put_failure;
position p;
@@

nl80211_get_ftm_responder_stats(...)
{
	...
	msg = nlmsg_new(NLMSG_DEFAULT_SIZE, GFP_KERNEL);
	...
	hdr = nl80211hdr_put(...);
	if (!hdr)
		return -ENOBUFS;@p
	...
nla_put_failure:
	nlmsg_free(msg);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19055')
