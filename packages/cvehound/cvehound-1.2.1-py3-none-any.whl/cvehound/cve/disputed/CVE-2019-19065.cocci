/// Files: drivers/infiniband/hw/hfi1/sdma.c
/// Fix: 34b3be18a04ecdc610aae4c48e5d1b799d8689f6
/// Fixes: 5a52a7acf7e2a812d2852342992cee3dc22ad25d

virtual detect

@err@
identifier tmp_sdma_rht, sdma_rht_params, bail;
position p;
@@

sdma_init(...)
{
	...
*	tmp_sdma_rht = kzalloc(...);
	...
*	ret = rhashtable_init(tmp_sdma_rht, &sdma_rht_params);
*	if (ret < 0)
*		goto bail;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19065')
