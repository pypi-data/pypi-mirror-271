/// Files: net/sctp/associola.c include/net/sctp/command.h
/// Fix: 1be9a950c646c9092fb3618197f7b6bfb50e82aa
/// Fixes: 730fc3d05cd4ba4c9ce2de91f3d43349e95dbbf5

virtual detect

@sctp_cmd_assoc_shkey@
@@

typedef enum {
	...,
*	SCTP_CMD_ASSOC_SHKEY,
	...
} sctp_verb_t;

@err depends on sctp_cmd_assoc_shkey exists@
identifier asoc, new;
position p;
@@

sctp_assoc_update(struct sctp_association *asoc,
		  struct sctp_association *new)
{
	... when != asoc->peer.auth_capable = new->peer.auth_capable;
*	sctp_tsnmap_init@p(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-5077')
