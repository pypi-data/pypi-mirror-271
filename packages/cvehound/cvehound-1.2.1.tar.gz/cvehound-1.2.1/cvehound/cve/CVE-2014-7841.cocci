/// Files: net/sctp/sm_make_chunk.c
/// Fix: e40607cbe270a9e8360907cb1e62ddf0736e4864
/// Fixes: d6de3097592b7ae7f8e233a4dafb088e2aa8170f

virtual detect

@err exists@
identifier af, param;
position pos;
@@

sctp_process_param(..., union sctp_params param, ...)
{
	...
	switch (param.p->type) {
	case SCTP_PARAM_SET_PRIMARY:
		...
*		af = sctp_get_af_specific@pos(...);
		... when != if (af == NULL) break;
*		af->from_addr_param(...);
		...
	}
	...
}

@script:python depends on detect@
pos << err.pos;
@@

coccilib.report.print_report(pos[0], 'ERROR: CVE-2014-7841')
