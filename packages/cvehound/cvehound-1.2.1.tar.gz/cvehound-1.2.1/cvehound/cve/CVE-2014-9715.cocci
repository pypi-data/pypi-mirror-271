/// Files: include/net/netfilter/nf_conntrack_extend.h include/net/netfilter/nf_conntrack_ecache.h
/// Fix: 223b02d923ecd7c84cf9780bb3686f455d279279
/// Fixes: 5b423f6a40a0327f9d40bc8b97ce9be266f74368

virtual detect

@timeout_field@
identifier timeout;
@@

struct nf_conntrack_ecache {
	...
	struct timer_list timeout;
};

@err depends on timeout_field@
identifier rcu, offset, len, data;
position p;
@@

struct nf_ct_ext {
 	struct rcu_head rcu;
*	u8 offset[NF_CT_EXT_NUM];
*	u8 len@p;
 	char data[0];
};

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-9715')
