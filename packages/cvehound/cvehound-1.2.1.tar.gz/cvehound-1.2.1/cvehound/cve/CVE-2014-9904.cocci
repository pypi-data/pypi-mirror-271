/// Files: sound/core/compress_offload.c
/// Fix: 6217e5ede23285ddfee10d2e4ba0cc2d4c046205
/// Fixes: b35cc8225845112a616e3a2266d2fde5ab13d3ab

virtual detect

@err exists@
identifier params;
position p;
@@

\(snd_compress_check_input\|snd_compr_allocate_buffer\)(..., struct snd_compr_params *params)
{
	...
*	params->buffer.fragments > SIZE_MAX@p / params->buffer.fragment_size
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-9904')
