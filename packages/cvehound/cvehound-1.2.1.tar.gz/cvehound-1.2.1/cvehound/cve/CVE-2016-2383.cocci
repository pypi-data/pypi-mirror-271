/// Files: kernel/bpf/verifier.c
/// Fix: a1b14d27ed0965838350f1377ff97c93ee383492
/// Fixes: 9bac3d6d548e5cc925570b263f35b70a00a00ffd

virtual detect

@err exists@
identifier prog, pos, delta, i, insn;
position p;
@@

adjust_branches(struct bpf_prog *prog, int pos, int delta)
{
	...
*	if (i > pos@p && i + insn->off + 1 < pos)
		insn->off -= delta;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-2383')
