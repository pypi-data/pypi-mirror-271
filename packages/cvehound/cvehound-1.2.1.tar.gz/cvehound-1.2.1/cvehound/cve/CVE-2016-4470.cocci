/// Files: security/keys/key.c
/// Fix: 38327424b40bcebe2de92d07312c89360ac9229a
/// Fixes: f70e2e06196ad4c1c762037da2f75354f6c16b81

virtual detect

@err exists@
identifier keyring;
position p;
@@

\(key_negate_and_link\|key_reject_and_link\)(..., struct key *keyring, ...)
{
	... when any
*	if (keyring@p)
*		__key_link_end(keyring,...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-4470')
