/// Files: arch/x86/kvm/emulate.c
/// Fix: d9092f52d7e61dd1557f2db2400ddb430e85937e
/// Fixes: 41061cdb98a0bec464278b4db8e894a3121671f5

virtual detect

@err exists@
identifier ctxt;
position p;
@@

x86_decode_insn(struct x86_emulate_ctxt *ctxt, ...)
{
	...
*	if (ctxt->rip_relative@p)
(
		ctxt->memopp->addr.mem.ea =
			address_mask(ctxt, ctxt->memopp->addr.mem.ea + ctxt->_eip);
|
		ctxt->memopp->addr.mem.ea += ctxt->_eip;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2016-8630')
