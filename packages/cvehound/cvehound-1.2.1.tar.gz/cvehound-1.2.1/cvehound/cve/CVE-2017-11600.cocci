/// Files: net/xfrm/xfrm_policy.c
/// Fix: 7bab09631c2a303f87a7eb7e3d69e888673b9b7e
/// Fixes: 80c9abaabf4283f7cf4a0b3597cd302506635b7f

virtual detect

@err@
identifier dir;
typedef u8;
position p;
@@

xfrm_migrate(..., u8 dir, ...)
{
	... when != XFRM_POLICY_MAX
*	xfrm_migrate_policy_find@p(..., dir, ...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-11600')
