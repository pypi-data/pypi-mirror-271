/// Files: net/core/net_namespace.c
/// Fix: 21b5944350052d2583e82dd59b19a9ba94a007f0
/// Fixes: 0c7aecd4bde4b7302cd41986d3a29e4f0b0ed218

virtual detect

@err exists@
identifier peer, net, id;
position p;
@@

get_net_ns_by_id(struct net *net, int id)
{
	...
	peer = idr_find(&net->netns_ids, id);
 	if (peer)
*		get_net@p(peer);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-15129')
