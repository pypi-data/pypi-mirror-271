/// Files: drivers/media/usb/cx231xx/cx231xx-cards.c drivers/media/video/cx231xx/cx231xx-cards.c
/// Fix: 6c3b047fa2d2286d5e438bcb470c7b1a49f415f6
/// Fixes: e0d3bafd02586cfde286c320f56906fd9fa8d256

virtual detect

@err exists@
identifier assoc_desc, udev, retval, ifnum;
statement S1, S2;
position p;
@@

cx231xx_usb_probe(...)
{
	... when any
*	assoc_desc = udev->actconfig->intf_assoc[0];
(
*	dev->max_iad_interface_count = assoc_desc@p->bInterfaceCount;
|
*	if (assoc_desc@p->bFirstInterface == ifnum)
		S1
|
*	if (assoc_desc@p->bFirstInterface != ifnum)
		S1
	else
		S2
)
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-16536')
