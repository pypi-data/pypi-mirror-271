/// Files: kernel/bpf/verifier.c
/// Fix: a5ec6ae161d72f01411169a938fa5f8baea16e8f
/// Fixes: f1174f77b50c94eecaa658fdc56fa69b421de4b8

virtual detect

@err@
identifier env, reg, strict, pointer_desc;
position p;
@@

check_ptr_alignment(struct bpf_verifier_env *env,
		    struct bpf_reg_state *reg, ...)
{
	...
*	bool strict = env->strict_alignment;
	...
	switch (reg->type) {
*	case PTR_TO_STACK:
*		pointer_desc =@p "stack ";
*		break;
	...
	}
	...
*	return check_generic_ptr_alignment(..., strict);
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-17856')
