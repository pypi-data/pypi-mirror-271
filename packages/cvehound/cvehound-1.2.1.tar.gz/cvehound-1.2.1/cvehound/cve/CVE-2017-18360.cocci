/// Files: drivers/usb/serial/io_ti.c
/// Fix: 6aeb75e6adfaed16e58780309613a578fe1ee90b
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier baud, tty, edge_port;
position p;
@@

change_port_settings(...)
{
	...
*	baud = tty_get_baud_rate(tty);
(
*	if (!baud) {
*		baud = 9600;
*	} else
*		tty_encode_baud_rate@p(tty, baud, baud);
|
*	if (!baud) {
*		baud = 9600;
*	}@p
)
	edge_port->baud_rate = baud;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-18360')
