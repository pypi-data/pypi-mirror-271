/// Files: drivers/scsi/aacraid/commctrl.c
/// Fix: 342ffc26693b528648bdc9377e51e4f2450b4860
/// Fixes: 423400e64d377c0d8a2459795420681177e51e74

virtual detect

@err@
identifier is_native_device, reply;
statement S;
position p;
@@

aac_send_raw_srb(...)
{
	...
	if (is_native_device) {
		...
*		struct aac_srb_reply reply@p;
		... when != memset(&reply, 0, sizeof(reply));
*		copy_to_user(..., &reply, sizeof(struct aac_srb_reply))
		...
	} else
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-18549')
