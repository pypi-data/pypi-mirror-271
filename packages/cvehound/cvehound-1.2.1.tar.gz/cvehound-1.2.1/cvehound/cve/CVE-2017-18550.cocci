/// Files: drivers/scsi/aacraid/commctrl.c
/// Fix: 342ffc26693b528648bdc9377e51e4f2450b4860
/// Fixes: c799d519bf088c0c5deb481b0190990417ace1bc

virtual detect

@err@
identifier dev, arg, hbainfo;
position p;
@@

aac_get_hba_info(struct aac_dev *dev, void *arg)
{
*	struct aac_hba_info hbainfo;@p
	... when != memset(&hbainfo, 0, sizeof(hbainfo));
*	copy_to_user(arg, &hbainfo, sizeof(struct aac_hba_info))
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-18550')
