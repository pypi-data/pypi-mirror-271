/// Files: drivers/gpu/drm/vc4/vc4_gem.c
/// Fix: 6b8ac63847bc2f958dd93c09edc941a0118992d9
/// Fixes: d5b1a78a772f1e31a94f8babfa964152ec5e9aa5

virtual detect

@err exists@
identifier fail, ret;
position p;
@@

vc4_get_bcl(...)
{
	...
	int ret = 0;
	...
*	if (...) {
		DRM_ERROR("overflow in exec arguments\n");
		... when != ret = -EINVAL;
*		goto fail;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-5577')
