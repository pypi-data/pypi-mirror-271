/// Files: net/ipv4/ip_sockglue.c
/// Fix: ca4ef4574f1ee5252e2cd365f8f5d5bafd048f32
/// Fixes: ad6f939ab193750cc94a265f58e007fb598c97b7

virtual detect

@err@
identifier skb, offset;
position p;
@@

ip_cmsg_recv_checksum(..., int offset)
{
	...
	if (offset != 0) {
		...
*		csum_partial@p(..., offset, 0)
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-6347')
