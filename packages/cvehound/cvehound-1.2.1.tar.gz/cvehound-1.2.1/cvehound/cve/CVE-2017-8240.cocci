/// Files: drivers/pinctrl/qcom/pinctrl-msm.c
/// Fix: bcd53f858d87f52843cc87764b283999126a50d6
/// Fixes: 327455817a92522e669d2d11367e42af5956a8ed

virtual detect

@err@
identifier i, pctrl;
position p;
statement S;
@@

msm_pinctrl_setup_pm_reset(struct msm_pinctrl *pctrl)
{
	...
*	for (...; i <=@p pctrl->soc->nfunctions; ...)
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-8240')
