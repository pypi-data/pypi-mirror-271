/// Files: drivers/usb/serial/io_ti.c
/// Fix: 654b404f2a222f918af9b0cd18ad469d0c941a8e
/// Fixes: v2.6.12-rc2

virtual detect

@err exists@
identifier port_number, edge_port, urb;
position p;
@@

edge_bulk_in_callback(...)
{
	...
*	if (edge_port->lsr_event@p) {
		edge_port->lsr_event = 0;
		...
		--urb->actual_length;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2017-8924')
