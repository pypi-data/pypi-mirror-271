/// Files: fs/nfsd/auth.c
/// Fix: 1995266727fa8143897e89b55f5d3c79aa828420
/// Fixes: bdcf0a423ea1c40bbb40e7ee483b50fc8aa3d758

virtual detect

@err@
identifier i, rqgi, gi, exp;
position p;
@@

nfsd_setuser(...)
{
	...
	for (i = 0; i < rqgi->ngroups; i++) {
		if (gid_eq(GLOBAL_ROOT_GID, rqgi->gid[i]))
			gi->gid[i] = exp->ex_anon_gid;
		else
			gi->gid[i] = rqgi->gid[i];
*		groups_sort@p(gi);
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-1000028')
