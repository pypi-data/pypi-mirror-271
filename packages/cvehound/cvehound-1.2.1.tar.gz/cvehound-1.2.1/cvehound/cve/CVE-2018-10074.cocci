/// Files: drivers/clk/hisilicon/clk-hi3660-stub.c
/// Fix: 9903e41ae1f5d50c93f268ca3304d4d7c64b9311
/// Fixes: 4f16f7ff3bc02f6e1845677235fea157bdc0e59c

virtual detect

@err exists@
identifier pdev, res;
position p;
@@

hi3660_stub_clk_probe(struct platform_device *pdev)
{
	...
	res = platform_get_resource@p(pdev, ...);
	... when != res == NULL
	devm_ioremap(..., res->start, ...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-10074')
