/// Files: fs/ext4/xattr.c
/// Fix: 8a2b307c21d4b290e3cbe33f768f194286d07c23
/// Fixes: dec214d00e0d78a08b947d7dccdfdb84407a9f4d

virtual detect

@err exists@
identifier s, here;
statement S;
position p;
@@

ext4_xattr_set_entry(...)
{
	...
*	if (!s->not_found &&@p here->e_value_offs)
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-10840')
