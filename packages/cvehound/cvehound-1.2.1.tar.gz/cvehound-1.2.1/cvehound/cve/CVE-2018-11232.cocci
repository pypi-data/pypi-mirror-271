/// Files: drivers/hwtracing/coresight/coresight-etm-perf.c
/// Fix: f09444639099584bc4784dfcd85ada67c6f33e0f
/// Fixes: d52c9750f150111dc7f73e4036f6948b20c9f8c3

virtual detect

@err@
identifier cpu, mask, sink;
iterator name for_each_cpu;
position p;
@@

etm_setup_aux(...)
{
	...
	for_each_cpu(cpu, mask) {
		...
	}
	... when != cpu = cpumask_first(mask);
	event_data->snk_config =@p
			sink_ops(sink)->alloc_buffer(..., cpu, ...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-11232')
