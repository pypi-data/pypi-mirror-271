/// Files: kernel/compat.c include/linux/compat.h
/// Fix: 0a0b98734479aa5b3c671d5190e86273372cab95
/// Fixes: 3a4d44b6162555070194e486ff6b3799a8d323a2

virtual detect

@field_tai@
symbol tai;
typedef compat_int_t;
@@

struct compat_timex {
	...
*	compat_int_t tai;
	...
};

@err depends on field_tai@
identifier txc, tx32;
position p;
@@

compat_get_timex(struct timex *txc, ...)
{
	... when != memset(txc, 0, ...);
*	copy_from_user@p(&tx32, ...)
	...
	txc->modes = tx32.modes;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-11508')
