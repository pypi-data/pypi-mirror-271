/// Files: fs/proc/base.c
/// Fix: f8a00cef17206ecd1b30d3d9f99e10d9fa707aa7
/// Fixes: 2ec220e27f5040aec1e88901c1b6ea3d135787ad

virtual detect

@err@
identifier m, trace;
position p;
symbol init_user_ns;
@@

proc_pid_stack(struct seq_file *m, ...)
{
	... when != if (!file_ns_capable(m->file, &init_user_ns, CAP_SYS_ADMIN)) return -EACCES;
*	trace.nr_entries =@p 0;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-17972')
