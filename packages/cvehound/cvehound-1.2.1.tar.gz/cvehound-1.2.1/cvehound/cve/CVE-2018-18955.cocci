/// Files: kernel/user_namespace.c
/// Fix: d2f007dbe7e4c9583eea6eb04d60001e85c6f1bd
/// Fixes: 6397fac4915ab3002dc15aae751455da1a852f25

virtual detect

@err exists@
identifier new_map, file;
position p;
@@

map_write(struct file *file, ...)
{
	...
*	new_idmap_permitted(file, ..., &new_map)
	... when != new_map
*	sort_idmaps@p(&new_map)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2018-18955')
