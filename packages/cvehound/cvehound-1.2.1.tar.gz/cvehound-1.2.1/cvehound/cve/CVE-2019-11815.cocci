/// Files: net/rds/tcp.c
/// Fix: cb66ddd156203daefb8d71158036b27b0e2caf63
/// Fixes: 467fa15356acfb7b2efa38839c3e76caa4e6e0ea

virtual detect

@err exists@
identifier net, c_net, tc;
iterator name list_for_each_entry_safe;
symbol rds_tcp_conn_list;
position p;
@@

rds_tcp_kill_sock(struct net *net)
{
	...
	list_for_each_entry_safe(tc, ..., &rds_tcp_conn_list, ...) {
		...
*		if (net != c_net ||@p !tc->t_sock)
			continue;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-11815')
