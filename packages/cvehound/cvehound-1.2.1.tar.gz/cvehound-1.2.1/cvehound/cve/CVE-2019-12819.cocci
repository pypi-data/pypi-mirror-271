/// Files: drivers/net/phy/mdio_bus.c
/// Fix: 6ff7b060535e87c2ae14dd8548512abfdda528fb
/// Fixes: 0c692d07842a67d9aa6b8266a80e4ac460a5c1a2

virtual detect

@err exists@
identifier bus, err;
position p;
@@

\(__mdiobus_register\|mdiobus_register\)(struct mii_bus *bus, ...)
{
	...
	err = device_register(&bus->dev);
	if (err) {
		...
*		put_device@p(&bus->dev);
		...
		return ...;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-12819')
