/// Files: drivers/gpu/drm/i915/i915_gem_userptr.c
/// Fix: c11c7bfd213495784b22ef82a69b6489f8d0092f
/// Fixes: 5cc9ed4b9a7ac579362ccebac67f7a4cdb36de06

virtual detect

@err exists@
identifier args;
position p;
@@

i915_gem_userptr_ioctl(...)
{
	... when != if (!args->user_size) return -EINVAL;
*	access_ok@p(..., args->user_size)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-12881')
