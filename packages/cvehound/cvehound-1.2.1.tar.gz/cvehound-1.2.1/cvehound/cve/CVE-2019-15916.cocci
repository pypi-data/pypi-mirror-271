/// Files: net/core/net-sysfs.c
/// Fix: 895a5e96dbd6386c8e78e5b78e067dcc67b7f0ab
/// Fixes: 1d24eb4815d1e0e8b451ecc546645f8ef1176d4f

virtual detect

@fix exists@
identifier dev;
@@

register_queue_kobjects(struct net_device *dev)
{
	...
//#ifdef CONFIG_SYSFS // Coccinelle can't handle
	kset_unregister(dev->queues_kset);
//#endif
	...
}

@err depends on !fix exists@
identifier dev;
position p;
@@

register_queue_kobjects(struct net_device *dev)
{
	...
*	net_rx_queue_update_kobjects@p(dev, ...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-15916')
