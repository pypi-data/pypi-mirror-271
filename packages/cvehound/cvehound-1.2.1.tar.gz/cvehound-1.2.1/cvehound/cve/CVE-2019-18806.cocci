/// Files: drivers/net/ethernet/qlogic/qla3xxx.c drivers/net/qla3xxx.c
/// Fix: 1acb8f2a7a9f10543868ddd737e37424d5c36cf4
/// Fixes: 0f8ab89e825f8c9f1c84c558ad7e2e4006aee0d3

virtual detect

@err exists@
identifier qdev, skb, err;
position p;
@@

ql_alloc_large_buffers(struct ql3_adapter *qdev)
{
	...
*	skb = netdev_alloc_skb(qdev->ndev,
*			       qdev->lrg_buffer_len);
	...
*	err = pci_dma_mapping_error(...);
	if (err) {
		... when != dev_kfree_skb_irq(skb);
*		return ...;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-18806')
