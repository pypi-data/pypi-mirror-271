/// Files: sound/soc/sof/ipc.c
/// Fix: 45c1380358b12bf2d1db20a5874e9544f56b34ab
/// Fixes: 54d198d5019dd98b9bcb9099a389608d7e2cccad

virtual detect

@err@
identifier cdata, sparams, send, err, partdata;
position p;
@@

sof_set_get_large_ctrl_data(...,
			    struct sof_ipc_ctrl_data *cdata,
			    struct sof_ipc_ctrl_data_params *sparams,
			    bool send)
{
	...
*	partdata = \(kmalloc\|kzalloc\)(...);
	...
	if (send)
		err = sof_get_ctrl_copy_params(cdata->type, cdata, partdata, sparams);
	else
		err = sof_get_ctrl_copy_params(cdata->type, partdata, cdata, sparams);
	if (err < 0)
*		return err;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-18811')
