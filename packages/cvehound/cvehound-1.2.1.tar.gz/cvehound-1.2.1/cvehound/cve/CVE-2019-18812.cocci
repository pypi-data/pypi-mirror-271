/// Files: sound/soc/sof/debug.c
/// Fix: c0a333d842ef67ac04adc72ff79dc1ccc3dca4ed
/// Fixes: 091c12e1f50cce93b1af90e56cad88787ec86dfb

virtual detect

@err@
identifier file, string, count;
expression dentry;
position p;
@@

sof_dfsentry_write(struct file *file, ..., size_t count, ...)
{
	...
*	string = kzalloc(count, GFP_KERNEL);
	...
*	if (strcmp(dentry->d_name.name, "ipc_flood_count") &&
*	    strcmp(dentry->d_name.name, "ipc_flood_duration_ms"))
*		return -EINVAL;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-18812')
