/// Files: drivers/virt/vboxguest/vboxguest_utils.c
/// Fix: e0b0cb9388642c104838fac100a4af32745621e2
/// Fixes: 579db9d45cb4e8e7cedff9e6079331a1e2ea9f5d

virtual detect

@err@
identifier bounce_buf_ret, bounce_buf, ret;
position p;
@@

hgcm_call_preprocess_linaddr(..., void **bounce_buf_ret, ...)
{
	...
*	bounce_buf = kvmalloc(...);
	...
	ret = copy_from_user(bounce_buf, ...);
	if (ret)
*		return -EFAULT;
	...
*	*bounce_buf_ret =@p bounce_buf;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19048')
