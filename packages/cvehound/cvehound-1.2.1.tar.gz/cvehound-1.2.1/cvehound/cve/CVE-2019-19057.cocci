/// Files: drivers/net/wireless/marvell/mwifiex/pcie.c
/// Fix: d10dcb615c8e29d403a24d35f8310a7a53e3050c
/// Fixes: 0732484b47b57ef90bb08408d60fddbad0262d82

virtual detect

@err@
identifier adapter, card, skb;
position p;
@@

mwifiex_pcie_init_evt_ring(struct mwifiex_adapter *adapter)
{
	...
*	skb = dev_alloc_skb(MAX_EVENT_SIZE);
	if (!skb) {
		...
*		kfree(card->evtbd_ring_vbase);
		return -ENOMEM;
	}
	...
*	if (mwifiex_map_pci_memory(adapter, skb, MAX_EVENT_SIZE,
*				   PCI_DMA_FROMDEVICE))
*		return -1;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19057')
