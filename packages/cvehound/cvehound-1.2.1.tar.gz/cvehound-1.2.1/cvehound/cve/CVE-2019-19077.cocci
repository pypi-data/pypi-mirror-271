/// Files: drivers/infiniband/hw/bnxt_re/ib_verbs.c
/// Fix: 4a9d46a9fe14401f21df69cea97c62396d5fb053
/// Fixes: 37cb11acf1f72a007a85894a6dd2ec93932bde46

virtual detect

@err exists@
identifier rc, udata;
symbol exit;
position p;
@@

bnxt_re_create_srq(..., struct ib_udata *udata)
{
	...
	if (udata) {
		...
*		rc = ib_copy_to_udata(udata, ...);
		... when != rc
		if (rc) {
			...
*			goto exit;@p
		}
	}
	...
//	FIXME: Coccinelle doesn't match
//fail:
//*	ib_umem_release(srq->umem);
//exit:
//*	return rc;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19077')
