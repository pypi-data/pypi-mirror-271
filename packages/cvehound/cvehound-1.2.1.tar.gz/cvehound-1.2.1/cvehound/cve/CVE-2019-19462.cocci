/// Files: kernel/relay.c
/// Fix: 54e200ab40fc14c863bcc80a51e20b7906608fce
/// Fixes: 017c59c042d01fc84cae7a8ea475861e702c77ab

virtual detect

@err@
position p;
@@

relay_open(...)
{
	...
*	chan->buf =@p alloc_percpu(struct rchan_buf *);
	... when != if (!chan->buf) { kfree(chan); return NULL; }
	chan->version = RELAYFS_CHANNEL_VERSION;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19462')
