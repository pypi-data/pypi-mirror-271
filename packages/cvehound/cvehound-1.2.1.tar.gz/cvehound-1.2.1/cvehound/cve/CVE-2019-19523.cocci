/// Files: drivers/usb/misc/adutux.c
/// Fix: 44efc269db7929f6275a1fa927ef082e533ecde0
/// Fixes: f08812d5eb8f8cd1a5bd5f5c26a96eb93d97ab69

virtual detect

@err@
identifier interface, dev, minor;
position p;
@@

adu_disconnect(struct usb_interface *interface)
{
	...
*	mutex_lock(&dev->mtx);
*	dev->udev = NULL;
(
*	minor = dev->minor;
|
)
*	usb_deregister_dev@p(interface, ...);
*	mutex_unlock(&dev->mtx);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19523')
