/// Files: drivers/net/can/usb/peak_usb/pcan_usb_pro.c
/// Fix: ead16e53c2f0ed946d82d4037c630e2f60f4ab69
/// Fixes: f14e22435a27ef183bbfa78f77ad86644c0b354c

virtual detect

@err@
identifier buffer, dev;
position p;
@@

pcan_usb_pro_drv_loaded(struct peak_usb_device *dev, ...)
{
	...
	buffer =@p kmalloc(PCAN_USBPRO_FCT_DRVLD_REQ_LEN, GFP_KERNEL);
	... when != memset(buffer, 0, ...);
	pcan_usb_pro_send_req(dev, PCAN_USBPRO_REQ_FCT,
				    PCAN_USBPRO_FCT_DRVLD, buffer,
				    PCAN_USBPRO_FCT_DRVLD_REQ_LEN)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19536')
