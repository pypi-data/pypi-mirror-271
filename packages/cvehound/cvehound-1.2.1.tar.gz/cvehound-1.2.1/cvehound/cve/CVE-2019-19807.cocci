/// Files: sound/core/timer.c
/// Fix: e7af6307a8a54f0b873960b32b6a644f2d0fbd97
/// Fixes: 41672c0c24a62699d20aab53b98d843b16483053

virtual detect

@err@
identifier timer, timeri, err, unlock;
position p;
@@

snd_timer_open(...)
{
	...
	if (!list_empty(&timer->open_list_head)) {
		...
*		timeri = list_entry(timer->open_list_head.next, ...);
*		if (timeri->flags & SNDRV_TIMER_IFLG_EXCLUSIVE) {
*			err = -EBUSY;
*			timeri =@p NULL;
*			goto unlock;
*		}
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19807')
