/// Files: fs/proc/proc_sysctl.c
/// Fix: 89189557b47b35683a27c80ee78aef18248eefb4
/// Fixes: 0e47c99d7fe25e0f3907d9f3401079169d904891

virtual detect

@err@
identifier header, parent;
position p;
@@

drop_sysctl_table(struct ctl_table_header *header)
{
	...
	if (--header->nreg)
		return;
(
*	put_links@p(header);
|
*	if (parent)
*		put_links@p(header);
)
	start_unregistering(header);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-20054')
