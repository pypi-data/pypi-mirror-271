/// Files: net/ipv6/ip6_fib.c
/// Fix: 7b09c2d052db4b4ad0b27b97918b46a7746966fa
/// Fixes: d64a1f574a2957b4bcb06452d36cc1c6bf16e9fc

virtual detect

@err exists@
identifier flags;
position p;
@@

fib6_rule_lookup(..., int flags, ...)
{
	...
	// NOTE: coccinelle bug if you use |@p
*	if (!(flags@p | RT6_LOOKUP_F_DST_NOREF))
*		dst_hold(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-20422')
