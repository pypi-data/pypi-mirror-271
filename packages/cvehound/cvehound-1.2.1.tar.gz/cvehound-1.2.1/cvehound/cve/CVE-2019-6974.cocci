/// Files: virt/kvm/kvm_main.c
/// Fix: cfa39381173d5f969daf43582c95ad679189cbc9
/// Fixes: 852b6d57dc7fa378019786fa84727036e56839ea

virtual detect

@err exists@
identifier kvm;
position p;
@@

//kvm_ioctl_create_device(struct kvm *kvm, ...)
//{
//	...
*	anon_inode_getfd(..., &kvm_device_fops, ...)
	...
*	kvm_get_kvm@p(kvm);
//	...
//}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-6974')
