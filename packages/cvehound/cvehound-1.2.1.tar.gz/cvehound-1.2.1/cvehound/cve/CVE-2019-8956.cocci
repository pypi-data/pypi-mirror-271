/// Files: net/sctp/socket.c
/// Fix: ba59fb0273076637f0add4311faa990a5eec27c0
/// Fixes: 4910280503f3af2857d5aa77e35b22d93a8960a8

virtual detect

@err@
identifier sflags, sk, asoc, ep, asocs;
position p;
iterator name list_for_each_entry;
@@

sctp_sendmsg(struct sock *sk, ...)
{
	...
	if ((sflags & SCTP_SENDALL) && sctp_style(sk, UDP)) {
*		list_for_each_entry@p(asoc, &ep->asocs, asocs) {
			...
		}
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-8956')
