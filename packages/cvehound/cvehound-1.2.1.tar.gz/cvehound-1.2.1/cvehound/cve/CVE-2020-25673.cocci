/// Files: net/nfc/llcp_sock.c
/// Fix: 4b5db93e7f2afbdfe3b78e37879a85290187e6f1
/// Fixes: b4011239a08e7e6c2c6e970dfa9e8ecb73139261

virtual detect

@err exists@
identifier sk;
position p;
@@

llcp_sock_connect(...)
{
	... when != if (sk->sk_state == LLCP_CONNECTING) { ... }
*	nfc_get_device@p(...)
	...
	sk->sk_state = LLCP_CONNECTING;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2020-25673')
