/// Files: fs/eventpoll.c
/// Fix: 77f4689de17c0887775bb77896f4cc11a39bf848
/// Fixes: a9ed4a6560b8562b7e2e2bed9527e88001f7b682

virtual detect

@err exists@
identifier epi, tfile_check_list;
position p;
@@

ep_loop_check_proc(...)
{
	...
	if (list_empty(&epi->ffd.file->f_tfile_llink)) {
*		get_file@p(epi->ffd.file);
		list_add(&epi->ffd.file->f_tfile_llink,
			 &tfile_check_list);
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-1048')
