/// Files: drivers/staging/rtl8188eu/os_dep/ioctl_linux.c
/// Fix: 74b6b20df8cfe90ada777d621b54c32e69e27cd7
/// Fixes: a2c60d42d97cdbeee3c7371cd3502fca77f07d39

virtual detect

@err@
identifier sec_len, ssdi, ssid_index, pos;
position p;
@@

rtw_wx_set_scan(...)
{
	...
	if (sec_len > 0 &&
	    sec_len <= len) {
(
		ssid[ssid_index].ssid_length = sec_len;
*		memcpy@p(ssid[ssid_index].ssid, pos, \(sec_len\|ssid[ssid_index].ssid_length\));
|
		ssid[ssid_index].SsidLength = sec_len;
*		memcpy@p(ssid[ssid_index].Ssid, pos, \(sec_len\|ssid[ssid_index].SsidLength\));
)
		ssid_index++;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-28660')
