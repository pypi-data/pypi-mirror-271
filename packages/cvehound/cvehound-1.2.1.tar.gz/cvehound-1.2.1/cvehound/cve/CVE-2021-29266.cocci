/// Files: drivers/vhost/vdpa.c
/// Fix: f6bbf0010ba004f5e90c7aefdebc0ee4bd3283b9
/// Fixes: 776f395004d829bbbf18c159ed9beb517a208c71

virtual detect

@err exists@
identifier v;
position p;
@@

vhost_vdpa_config_put(struct vhost_vdpa *v)
{
	...
	if (v->config_ctx) {
*		eventfd_ctx_put@p(v->config_ctx);
		... when != v->config_ctx = NULL;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-29266')
