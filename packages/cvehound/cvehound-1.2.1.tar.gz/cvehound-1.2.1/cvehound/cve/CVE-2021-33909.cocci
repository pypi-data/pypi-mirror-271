/// Files: fs/seq_file.c
/// Fix: 8cae8cd89f05f6de223d63e6d15e31c8ba9cf53b
/// Fixes: 058504edd02667eef8fac9be27ab3ea74332e9b4

virtual detect

@fix exists@
identifier size;
@@

seq_buf_alloc(unsigned long size)
{
	...
	if (unlikely(size > MAX_RW_COUNT))
		return NULL;
	...
}

@err depends on !fix exists@
position p;
@@

* seq_buf_alloc@p(unsigned long size)
{
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-33909')
