/// Files: kernel/bpf/verifier.c
/// Fix: 049c4e13714ecbca567b4d5f6d563f05d431c80e
/// Fixes: 3f50f132d8400e129fc9eb68b5020167ef80a244

virtual detect

@err exists@
identifier src_known, dst_known;
position p;
@@

\(scalar32_min_max_and\|scalar32_min_max_or\|scalar32_min_max_xor\)(...)
{
	bool src_known = ...;
	bool dst_known = ...;
	...
*	if (src_known &&@p dst_known)
		return;
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3490')
