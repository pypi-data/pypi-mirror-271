/// Files: net/bluetooth/hci_core.c
/// Fix: 6a137caec23aeb9e036cdfd8a46dd8a366460e5d
/// Detect-To: b78752cc71d86998d3b77d873c61d6ffdb7a2142

virtual detect

@err exists@
identifier hdev;
position p;
@@

\(hci_dev_open\|hci_dev_do_open\)(...)
{
        ...
*       \(flush_work@p\|tasklet_kill@p\)(&hdev->\(cmd_work\|cmd_task\));
        \(flush_work\|tasklet_kill\)(&hdev->\(rx_work\|rx_task\));
        ...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3564')
