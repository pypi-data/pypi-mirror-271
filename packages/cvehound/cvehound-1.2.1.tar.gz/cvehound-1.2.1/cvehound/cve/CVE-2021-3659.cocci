/// Files: net/mac802154/llsec.c
/// Fix: 1165affd484889d4986cf3b724318935a0b120d8
/// Detect-To: 5d637d5aabd85132bd85779677d8acb708e0ed90
/// Version: 1.1.0

virtual detect

@err exists@
identifier i, key;
position p;
@@

llsec_key_alloc(...)
{
	...
	for (i = 0; i < ARRAY_SIZE(key->tfm); i++)
*		if (key->tfm[i]@p)
			crypto_free_aead(key->tfm[i]);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3659')
