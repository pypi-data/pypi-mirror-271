/// Files: net/sched/cls_route.c
/// Fix: ef299cc3fa1a9e1288665a9fdc8bff55629fd359
/// Fixes: 1109c00547fc66df45b9ff923544be4c1e1bec13

virtual detect

@err exists@
identifier pfp, fp, f;
position p;
@@

route4_change(...)
{
	...
	for (pfp = rtnl_dereference(*fp); pfp;
	     fp = &pfp->next, pfp = rtnl_dereference(*fp)) {
*		if (pfp == f) {
*			*fp =@p f->next;
*			break;
		}
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3715')
