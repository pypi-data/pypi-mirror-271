/// Files: drivers/infiniband/core/cma.c
/// Fix: bc0bdc5afaa740d782fbf936aaeebd65e5c2921d
/// Fixes: 732d41c545bb359cbb8c94698bdc1f8bcf82279c

virtual detect

@err@
identifier id, id_priv;
position p;
@@

rdma_listen(struct rdma_cm_id *id, ...)
{
	...
	if (!cma_comp_exch(id_priv, RDMA_CM_ADDR_BOUND, RDMA_CM_LISTEN)) {
*		id->route.addr.src_addr.ss_family = AF_INET;
*		ret =@p rdma_bind_addr(id, cma_src_addr(id_priv));
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-4028')
