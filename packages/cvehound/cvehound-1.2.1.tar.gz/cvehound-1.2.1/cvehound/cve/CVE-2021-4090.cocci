/// Files: fs/nfsd/nfs4xdr.c
/// Fix: c0019b7db1d7ac62c711cda6b357a659d46428fe
/// Fixes: d1c263a031e876ac3ca5223c728e4d98ed50b3c0

virtual detect

@err@
identifier bmval, bmlen, i, count;
position p;
typedef u32;
@@

nfsd4_decode_bitmap4(..., u32 *bmval, u32 bmlen)
{
	...
*	while (i < count)
*		bmval[i++] =@p be32_to_cpup(...);
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-4090')
