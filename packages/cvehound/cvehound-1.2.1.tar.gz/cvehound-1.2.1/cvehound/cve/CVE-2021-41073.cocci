/// Files: fs/io_uring.c
/// Fix: 16c8d2df7ec0eed31b7d3b61cb13206a7fb930cc
/// Fixes: 4017eb91a9e79bbb5d14868c207436f4a6a0af50

virtual detect

@err exists@
identifier iter, req, nr, ret, iovec;
position p;
@@

loop_rw_iter(..., struct iov_iter *iter)
{
	...
	ret += nr;
	if (nr != iovec.iov_len)
		break;
*	req->rw.len -= nr;
*	req->rw.addr += nr;
*	iov_iter_advance@p(iter, nr);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-41073')
