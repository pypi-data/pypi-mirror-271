/// Files: kernel/cgroup/cgroup-v1.c
/// Fix: 3b0462726e7ef281c35a7a4ae33e93ee2bc9975b
/// Fixes: 8d2451f4994fa60a57617282bab91b98266a00b1

virtual detect

@err exists@
identifier fc, param, fs_value_is_string;
position p;
@@

cgroup1_parse_param(struct fs_context *fc, struct fs_parameter *param)
{
	...
	if (strcmp(param->key, "source") == 0) {
		... when != if (param->type != fs_value_is_string) return invalf(fc, ...);
* 		fc->source =@p param->string;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-4154')
