/// Files: drivers/isdn/capi/kcapi.c
/// Fix: 1f3e2e97c003f80c4b087092b225c8787ff91e4d
/// Detect-To: v2.6.12-rc2

virtual detect

@err@
identifier ctr, capi_controller;
statement S;
position p;
@@

detach_capi_ctr(struct capi_ctr *ctr)
{
	... when != if (ctr->cnr < 1 || ctr->cnr - 1 >= CAPI_MAXCONTR) S
	capi_controller@p[ctr->cnr - 1]
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-43389')
