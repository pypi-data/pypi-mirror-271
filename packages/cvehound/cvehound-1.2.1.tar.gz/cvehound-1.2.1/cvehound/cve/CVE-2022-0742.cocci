/// Files: net/ipv6/mcast.c
/// Fix: 2d3916f3189172d5c69d33065c3c21119fe539fc
/// Fixes: f185de28d9ae6c978135993769352e523ee8df06

virtual detect

@err@
identifier skb, idev;
position p;
@@

int \(igmp6_event_query\|igmp6_event_report\)(struct sk_buff *skb)
{
	struct inet6_dev *idev = __in6_dev_get(skb->dev);

*	if (!idev)
*		return -EINVAL;

	if (idev->dead) {
		kfree_skb(skb);
		return -ENODEV;
	}

	...

*	return 0;@p
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0742')
