/// Files: fs/udf/namei.c
/// Fix: c1ad35dd0548ce947d97aaf92f7f2f9a202951cf
/// Fixes: 979a6e28dd969a2222545001f79566b4bfaf06c0

virtual detect

@err@
identifier lfi, sfi;
position p;
@@

udf_write_fi(..., struct fileIdentDesc *sfi, ...)
{
	... when any
*	\(memcpy@p\|memset@p\)(\(udf_get_fi_ident(sfi)\|udf_get_fi_ident(sfi) + lfi\), ...);
	... when any
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-1943')
