/// Files: drivers/usb/gadget/function/rndis.c
/// Fix: 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa
/// Fixes: 38ea1eac7d88072bbffb630e2b3db83ca649b826

virtual detect

@err@
identifier BufLength, BufOffset, buf;
typedef rndis_set_msg_type;
position p;
@@

rndis_set_response(..., rndis_set_msg_type *buf)
{
	...
	BufLength = le32_to_cpu(buf->InformationBufferLength);
 	BufOffset = le32_to_cpu(buf->InformationBufferOffset);
*	if ((BufLength > RNDIS_MAX_TOTAL_SIZE) ||@p
*	    (BufOffset + 8 >= RNDIS_MAX_TOTAL_SIZE))
*		return -EINVAL;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-20423')
