/// Files: drivers/net/hamradio/yam.c
/// Fix: 29eb31542787e1019208a2e1047bb7c76c069536
/// Fixes: 0781168e23a2fc8dceb989f11fc5b39b3ccacc35

virtual detect

@err@
identifier ym;
position p;
@@

switch (...) {
	case SIOCYAMSMCS:
		...
*		ym = memdup_user(...);
		...
*		if (ym->cmd != SIOCYAMSMCS)
*			return -EINVAL;@p
		...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-24959')
