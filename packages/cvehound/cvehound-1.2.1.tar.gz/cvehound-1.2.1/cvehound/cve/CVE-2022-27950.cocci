/// Files: drivers/hid/hid-elo.c
/// Fix: 817b8b9c5396d2b2d92311b46719aad5d3339dbe
/// Fixes: fbf42729d0e91332e8ce75a1ecce08b8a2dab9c1

virtual detect

@err@
identifier priv, udev, err_free;
position p;
@@

elo_probe(...)
{
	...
	priv = kzalloc(...);
	...
*	usb_get_dev(udev)
	...
err_free:
	... when != usb_put_dev(udev);
*	kfree(priv);@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-27950')
