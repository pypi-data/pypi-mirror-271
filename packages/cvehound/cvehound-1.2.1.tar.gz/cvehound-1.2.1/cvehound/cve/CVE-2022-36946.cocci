/// Files: net/netfilter/nfnetlink_queue.c
/// Fix: 99a63d36cb3ed5ca3aa6fcb64cffbeaf3b0fb164
/// Fixes: 7af4cc3fa158ff1dda6e7451c7e6afa6b0bb85cb

virtual detect

@err@
identifier data, data_len, e, min_len, diff;
statement S;
position p;
@@

nfqnl_mangle(void *data, int data_len, ...)
{
	...
*	if (diff < 0) {
*		... when != if (data_len < min_len) return ...;
*		\(pskb_trim@p\|skb_trim@p\)(e->skb, data_len)
		...
	} else S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-36946')
