/// Files: net/mac80211/util.c
/// Fix: ff05d4b45dd89b922578dac497dcabf57cf771c6
/// Fixes: 5023b14cf4df4d22e1a80738167f3438c9e62e5f

virtual detect

@err@
identifier nontransmitted_profile, nontransmitted_profile_len, non_inherit;
position p;
@@

\(ieee802_11_parse_elems_crc\|ieee802_11_parse_elems_full\)(...)
{
	...
*	nontransmitted_profile =@p kmalloc(..., GFP_ATOMIC);
*	if (nontransmitted_profile) {
*		nontransmitted_profile_len =
*			ieee802_11_find_bssid_profile(...);
*		non_inherit =
*			cfg80211_find_ext_elem(WLAN_EID_EXT_NON_INHERITANCE,
*					       nontransmitted_profile,
*					       nontransmitted_profile_len);
*	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-42719')
