/// Files: net/wireless/scan.c
/// Fix: bcca852027e5878aec911a347407ecc88d6fff7f
/// Fixes: 0b8fb8235be8be99a197e8d948fc0a2df8dc261a

virtual detect

@err@
identifier nontrans_bss, trans_bss;
position p;
@@

cfg80211_add_nontrans_list(...)
{
	... when != if (!list_empty(&nontrans_bss->nontrans_list)) return -EINVAL;
*	list_add_tail@p(&nontrans_bss->nontrans_list, &trans_bss->nontrans_list);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-42721')
