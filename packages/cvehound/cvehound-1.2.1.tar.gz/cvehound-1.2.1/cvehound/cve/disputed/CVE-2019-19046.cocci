/// Files: drivers/char/ipmi/ipmi_msghandler.c
/// Fix: 4aa7afb0ee20a97fbf0c5bab3df028d5fb85fdab
/// Fixes: 68e7e50f195f34d0d539282779cad073d999192b

virtual detect

@err@
identifier rv, old_bmc, bmc, out;
symbol ipmi_bmc_ida;
statement S;
position p;
@@

\(__ipmi_bmc_register\|ipmi_bmc_register\)(...)
{
	...
	if (old_bmc)
		S
	else {
		...
*		rv = ida_simple_get(&ipmi_bmc_ida, ...);
		if (rv < 0)
*			goto out;@p
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19046')
