/// Files: drivers/of/unittest.c
/// Fix: e13de8fe0d6a51341671bbe384826d527afe8d44
/// Fixes: b951f9dc7f25fc1e39aafda5edb4b47b38285d9f

virtual detect

@err@
identifier unittest_data, unittest_data_node;
position p;
@@

\(selftest_data_add\|unittest_data_add\)(void)
{
	...
*	of_fdt_unflatten_tree(unittest_data, ..., &unittest_data_node);
	if (!unittest_data_node) {
		... when != kfree(unittest_data);
*		return -ENODATA;@p
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19049')
