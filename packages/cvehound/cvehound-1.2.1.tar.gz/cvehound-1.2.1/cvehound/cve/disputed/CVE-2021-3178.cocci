/// Files: fs/nfsd/nfs3xdr.c
/// Fix: 51b2ee7d006a736a9126e8111d1f24e4fd0afaa6
/// Detect-To: v2.6.12-rc2

virtual detect

@err exists@
identifier namlen, dchild, dparent, exp;
position p;
statement S;
@@

compose_entry_fh(..., int namlen, ...)
{
	...
	if (namlen == 2) {
*		dchild =@p dget_parent(dparent);
		... when != dparent == exp->ex_path.dentry
		    when forall
	} else S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2021-3178')
