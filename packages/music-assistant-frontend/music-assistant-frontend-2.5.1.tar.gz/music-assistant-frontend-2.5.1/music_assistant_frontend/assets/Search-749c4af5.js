import{d as T,r as s,I as w,o as $,s as r,a as _,c as i,h as f,f as m,w as d,m as B,t as I,u as g,F as k,i as S,b as F,e as y,j as C}from"./index-43311bc3.js";import{V as L,_ as E,a as N}from"./ItemsListing.vue_vue_type_style_index_0_lang-784b9943.js";import{V as R}from"./VToolbar-b1ca2657.js";import{a as x}from"./forwardRefs-651c2bd6.js";import{V as D}from"./VTextField-9b7f128a.js";import"./ListviewItem-2b5b6af3.js";import"./VBadge-fcbfaeb4.js";import"./Container-9a0c901a.js";import"./Button-8f8a6597.js";import"./VMenu-7c64b634.js";/* empty css              */import"./VInput-54c6b2cd.js";import"./VSlideGroup-390b1a05.js";import"./VCard-6b86821e.js";import"./VCardText-bdb89c1f.js";import"./VTooltip-6463f4cd.js";import"./PanelviewItem.vue_vue_type_style_index_0_lang-c2c2aaac.js";import"./contextmenu-7f33cf6e.js";import"./Alert-95d71572.js";import"./VAlert-8faad15a.js";import"./VVirtualScroll-898a23a9.js";import"./layout-679c2edc.js";const se=T({__name:"Search",setup(U){const p=s(),n=s(!1),a=s(),h=s(!1),v=s();w(()=>r.globalSearchTerm,()=>{clearTimeout(v.value),v.value=setTimeout(()=>{V()},200)},{immediate:!0});const V=async function(){h.value=!0,localStorage.setItem("globalsearch",r.globalSearchTerm||""),r.globalSearchTerm?a.value=await F.search(r.globalSearchTerm):a.value=void 0,h.value=!1,p.value=r.globalSearchTerm},c=function(e){if(!a.value)return[];if(e=="artists")return a.value.artists;if(e=="albums")return a.value.albums;if(e=="tracks")return a.value.tracks;if(e=="playlists")return a.value.playlists;if(e=="radio")return a.value.radio;if(e=="topresult"){const l=[];for(const o of[a.value.tracks,a.value.artists,a.value.albums,a.value.playlists,a.value.radio]){const t=[];for(const u of o)t.includes(u.provider)||(l.push(u),t.push(u.provider))}return l}return[]};$(()=>{if(!r.globalSearchTerm){const e=localStorage.getItem("globalsearch");e&&e!=="null"&&(r.globalSearchTerm=e)}});const b=function(e){!n.value&&e.key=="Backspace"&&r.globalSearchTerm?r.globalSearchTerm=r.globalSearchTerm.slice(0,-1):!n.value&&e.key.length==1&&(r.globalSearchTerm+=e.key)};return document.addEventListener("keydown",b),_(()=>{document.removeEventListener("keydown",b)}),(e,l)=>(i(),f("section",null,[m(R,{variant:"flat",color:"transparent"},{title:d(()=>[B(I(e.$t("search")),1)]),_:1}),m(x),m(D,{id:"searchInput",modelValue:g(r).globalSearchTerm,"onUpdate:modelValue":l[0]||(l[0]=o=>g(r).globalSearchTerm=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("type_to_search"),"hide-details":"",variant:"filled",onFocus:l[1]||(l[1]=o=>n.value=!0),onBlur:l[2]||(l[2]=o=>n.value=!1)},null,8,["modelValue","label"]),(i(),f(k,null,S([["topresult","tracks"],["artists","albums"],["playlists","radio"]],o=>m(N,{key:o[0]+o[1]},{default:d(()=>[(i(!0),f(k,null,S(o.filter(t=>c(t).length),t=>(i(),y(L,{key:t},{default:d(()=>[c(t).length?(i(),y(E,{key:0,itemtype:`search.${t}`,path:`search.${p.value}`,"show-provider":!0,"show-favorites-only-filter":!1,"show-select-button":!1,"show-refresh-button":!1,"load-items":async u=>c(t),title:e.$t(t),"allow-key-hooks":!1,"show-search-button":!1,limit:8,"infinite-scroll":!1,"sort-keys":["original"]},null,8,["itemtype","path","load-items","title"])):C("",!0)]),_:2},1024))),128))]),_:2},1024)),64))]))}});export{se as default};
