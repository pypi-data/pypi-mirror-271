import{m as ce,V as U}from"./VTextField-46c02b72.js";import{a5 as J,I as _,l as Y,aD as de,ap as fe,m as me,aE as ve,r as B,aq as $,z as k,a_ as j,f as r,F as O,E as S,b0 as pe,G as he,b1 as ye,at as ge,b2 as z}from"./index-1fa25223.js";import{h as Ve,V as we}from"./VLabel-148b546a.js";import{e as be,V as ke,f as Ce}from"./VMenu-85495654.js";import{m as Pe,b as xe,a as Se}from"./VList-f519ecda.js";import{J as De,u as Te,V as W,v as Ie,o as G,C as Ae}from"./VListItem-53d44b85.js";import{V as Fe}from"./VVirtualScroll-f6a01209.js";import{V as Re}from"./VCheckboxBtn-4c4cfeff.js";function Be(e,L){const n=J(!1);let y;function p(i){cancelAnimationFrame(y),n.value=!0,y=requestAnimationFrame(()=>{y=requestAnimationFrame(()=>{n.value=!1})})}async function I(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(n.value){const a=_(n,()=>{a(),i()})}else i()})}async function D(i){var A,F;if(i.key==="Tab"&&((A=L.value)==null||A.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(F=e.value)==null?void 0:F.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await I();const g=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const o=a.getBoundingClientRect().top;for(const V of g)if(V.getBoundingClientRect().top>=o){V.focus();break}}else{const o=a.getBoundingClientRect().bottom;for(const V of[...g].reverse())if(V.getBoundingClientRect().bottom<=o){V.focus();break}}}return{onListScroll:p,onListKeydown:D}}const Le=Y({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:de,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Pe({itemChildren:!1})},"Select"),Ee=Y({...Le(),...fe(ce({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...De({transition:{component:be}})},"VSelect"),$e=me()({name:"VSelect",props:Ee(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,L){let{slots:n}=L;const{t:y}=ve(),p=B(),I=B(),D=B(),i=$(e,"menu"),a=k({get:()=>i.value,set:t=>{var l;i.value&&!t&&((l=I.value)!=null&&l.Î¨openChildren)||(i.value=t)}}),{items:g,transformIn:A,transformOut:F}=xe(e),o=$(e,"modelValue",[],t=>A(t===null?[null]:ye(t)),t=>{const l=F(t);return e.multiple?l:l[0]??null}),V=k(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:o.value.length),C=Ve(),Q=k(()=>o.value.map(t=>t.value)),w=J(!1),K=k(()=>a.value?e.closeText:e.openText);let E="",H;const P=k(()=>e.hideSelected?g.value.filter(t=>!o.value.some(l=>l===t)):g.value),M=k(()=>e.hideNoData&&!P.value.length||e.readonly||(C==null?void 0:C.isReadonly.value)),X=k(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),T=B(),{onListScroll:Z,onListKeydown:ee}=Be(T,p);function te(t){e.openOnClear&&(a.value=!0)}function ne(){M.value||(a.value=!a.value)}function le(t){var u,m;if(!t.key||e.readonly||C!=null&&C.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(u=T.value)==null||u.focus("first"):t.key==="End"&&((m=T.value)==null||m.focus("last"));const l=1e3;function c(s){const v=s.key.length===1,d=!s.ctrlKey&&!s.metaKey&&!s.altKey;return v&&d}if(e.multiple||!c(t))return;const b=performance.now();b-H>l&&(E=""),E+=t.key.toLowerCase(),H=b;const h=g.value.find(s=>s.title.toLowerCase().startsWith(E));if(h!==void 0){o.value=[h];const s=P.value.indexOf(h);j&&window.requestAnimationFrame(()=>{var v;s>=0&&((v=D.value)==null||v.scrollToIndex(s))})}}function R(t){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!t.props.disabled)if(e.multiple){const c=o.value.findIndex(h=>e.valueComparator(h.value,t.value)),b=l??!~c;if(~c){const h=b?[...o.value,t]:[...o.value];h.splice(c,1),o.value=h}else b&&(o.value=[...o.value,t])}else{const c=l!==!1;o.value=c?[t]:[],ge(()=>{a.value=!1})}}function ae(t){var l;(l=T.value)!=null&&l.$el.contains(t.relatedTarget)||(a.value=!1)}function oe(){var t;w.value&&((t=p.value)==null||t.focus())}function ue(t){w.value=!0}function ie(t){if(t==null)o.value=[];else if(z(p.value,":autofill")||z(p.value,":-webkit-autofill")){const l=g.value.find(c=>c.title===t);l&&R(l)}else p.value&&(p.value.value="")}return _(a,()=>{if(!e.hideSelected&&a.value&&o.value.length){const t=P.value.findIndex(l=>o.value.some(c=>e.valueComparator(c.value,l.value)));j&&window.requestAnimationFrame(()=>{var l;t>=0&&((l=D.value)==null||l.scrollToIndex(t))})}}),_(()=>e.items,(t,l)=>{a.value||w.value&&!l.length&&t.length&&(a.value=!0)}),Te(()=>{const t=!!(e.chips||n.chip),l=!!(!e.hideNoData||P.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),c=o.value.length>0,b=U.filterProps(e),h=c||!w.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return r(U,S({ref:p},b,{modelValue:o.value.map(u=>u.props.value).join(", "),"onUpdate:modelValue":ie,focused:w.value,"onUpdate:focused":u=>w.value=u,validationValue:o.externalValue,counterValue:V.value,dirty:c,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":o.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:h,"onClick:clear":te,"onMousedown:control":ne,onBlur:ae,onKeydown:le,"aria-label":y(K.value),title:y(K.value)}),{...n,default:()=>r(O,null,[r(ke,S({ref:I,modelValue:a.value,"onUpdate:modelValue":u=>a.value=u,activator:"parent",contentClass:"v-select__content",disabled:M.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:oe},X.value),{default:()=>[l&&r(Se,S({ref:T,selected:Q.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:ee,onFocusin:ue,onScrollPassive:Z,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var u,m,s;return[(u=n["prepend-item"])==null?void 0:u.call(n),!P.value.length&&!e.hideNoData&&(((m=n["no-data"])==null?void 0:m.call(n))??r(W,{title:y(e.noDataText)},null)),r(Fe,{ref:D,renderless:!0,items:P.value},{default:v=>{var N;let{item:d,index:x,itemRef:f}=v;const q=S(d.props,{ref:f,key:x,onClick:()=>R(d,null)});return((N=n.item)==null?void 0:N.call(n,{item:d,index:x,props:q}))??r(W,S(q,{role:"option"}),{prepend:se=>{let{isSelected:re}=se;return r(O,null,[e.multiple&&!e.hideSelected?r(Re,{key:d.value,modelValue:re,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependAvatar&&r(Ie,{image:d.props.prependAvatar},null),d.props.prependIcon&&r(G,{icon:d.props.prependIcon},null)])}})}}),(s=n["append-item"])==null?void 0:s.call(n)]}})]}),o.value.map((u,m)=>{function s(f){f.stopPropagation(),f.preventDefault(),R(u,!1)}const v={"onClick:close":s,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),s(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},d=t?!!n.chip:!!n.selection,x=d?pe(t?n.chip({item:u,index:m,props:v}):n.selection({item:u,index:m})):void 0;if(!(d&&!x))return r("div",{key:u.value,class:"v-select__selection"},[t?n.chip?r(Ae,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>[x]}):r(we,S({key:"chip",closable:e.closableChips,size:"small",text:u.title,disabled:u.props.disabled},v),null):x??r("span",{class:"v-select__selection-text"},[u.title,e.multiple&&m<o.value.length-1&&r("span",{class:"v-select__selection-comma"},[he(",")])])])})]),"append-inner":function(){var v;for(var u=arguments.length,m=new Array(u),s=0;s<u;s++)m[s]=arguments[s];return r(O,null,[(v=n["append-inner"])==null?void 0:v.call(n,...m),e.menuIcon?r(G,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Ce({isFocused:w,menu:a,select:R},p)}});export{$e as V};
