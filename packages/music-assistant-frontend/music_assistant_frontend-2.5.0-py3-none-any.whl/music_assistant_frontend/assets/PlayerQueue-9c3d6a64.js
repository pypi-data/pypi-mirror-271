import{d as Y,k as Z,a1 as ee,r as w,l as U,s as l,o as te,b as c,ah as x,a as ue,I as le,c as r,h as A,f as e,w as a,m as y,t as p,u as o,e as v,j as f,E as ae,F as ie,i as ne,g as k,al as h,G as D,V as oe,M as re}from"./index-0ae84607.js";import{L as se}from"./ListviewItem-156d947d.js";import{B as de}from"./Button-a1dfd3f5.js";import{L as _,C as me}from"./Container-eb92362b.js";import{A as K}from"./Alert-ee4ff93d.js";import{V as B}from"./VBadge-bfb26993.js";import{a as z,V as pe}from"./VTabs-6b306fb2.js";import{b as g,V as I,a as P}from"./forwardRefs-d0d7c5bd.js";import{V as H,c as ve,b}from"./VMenu-f26d3a19.js";import{V as J,a as O}from"./VToolbar-b7dd8339.js";import{V as ce}from"./VVirtualScroll-06bbaaf5.js";import{V as fe}from"./VCard-e96ab32b.js";import{V as _e}from"./VCardText-b1a0de89.js";import{V as ye}from"./VDialog-2b5eada8.js";import"./VTooltip-054ea37d.js";import"./VInput-00e20677.js";import"./VSlideGroup-18f8a11f.js";/* empty css              */import"./VAlert-212471f5.js";const ge=k("br",null,null,-1),be={key:0},Re=Y({__name:"PlayerQueue",setup(qe){const{t:W}=Z(),L=ee(),M=w(0),d=w(),V=w(!1),$=w([]),q=w([]),T=U(()=>l.activePlayerQueue?q.value.slice(l.activePlayerQueue.current_index):[]),S=U(()=>l.activePlayerQueue?q.value.slice(0,l.activePlayerQueue.current_index):[]),X=U(()=>M.value==1?S.value:T.value);te(()=>{const t=c.subscribe_multi([x.QUEUE_UPDATED,x.QUEUE_ITEMS_UPDATED],i=>{var u;i.object_id==((u=l.activePlayerQueue)==null?void 0:u.queue_id)&&(i.event==x.QUEUE_ITEMS_UPDATED?N():F())});ue(t)});const N=async function(){l.activePlayerQueue?(q.value=[],await c.getPlayerQueueItems(l.activePlayerQueue.queue_id,t=>{q.value.push(...t)})):q.value=[]},R=function(t){d.value=t,V.value=!0},j=function(t){E(),L.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},C=function(t,i){var u,n,s,m,Q;E(),!(!t||!l.activePlayerQueue)&&(i=="play_now"?c.queueCommandPlayIndex((u=l.activePlayerQueue)==null?void 0:u.queue_id,t.queue_item_id):i=="move_next"?c.queueCommandMoveNext((n=l.activePlayerQueue)==null?void 0:n.queue_id,t.queue_item_id):i=="up"?c.queueCommandMoveUp((s=l.activePlayerQueue)==null?void 0:s.queue_id,t.queue_item_id):i=="down"?c.queueCommandMoveDown((m=l.activePlayerQueue)==null?void 0:m.queue_id,t.queue_item_id):i=="delete"&&c.queueCommandDelete((Q=l.activePlayerQueue)==null?void 0:Q.queue_id,t.queue_item_id))},F=function(){$.value=[{label:"settings.player_settings",labelArgs:[],action:()=>{L.push(`/settings/editplayer/${l.activePlayerQueue.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{c.queueCommandClear(l.activePlayerQueue.queue_id)},icon:"mdi-cancel"},{label:l.activePlayerQueue.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{c.queueCommandShuffleToggle(l.activePlayerQueue.queue_id)},icon:l.activePlayerQueue.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[W(`repeatmode.${l.activePlayerQueue.repeat_mode}`)],action:()=>{c.queueCommandRepeatToggle(l.activePlayerQueue.queue_id)},icon:l.activePlayerQueue.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"}]},E=function(){d.value=void 0,V.value=!1};return le(()=>l.activePlayerQueue,t=>{t&&(N(),F())},{immediate:!0}),(t,i)=>(r(),A("section",null,[e(J,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:a(()=>{var u;return[y(p(t.$t("queue"))+" | "+p((u=o(l).selectedPlayer)==null?void 0:u.display_name)+" ",1),o(D)("bp6")?f("",!0):(r(),v(B,{key:0,color:"grey",content:T.value.length,inline:""},null,8,["content"]))]}),append:a(()=>[o(D)("bp6")?(r(),v(pe,{key:0,modelValue:M.value,"onUpdate:modelValue":i[0]||(i[0]=u=>M.value=u),"show-arrows":"",grow:""},{default:a(()=>[e(z,{value:0},{default:a(()=>[y(p(t.$t("queue_next_items"))+" ",1),e(B,{color:"grey",content:T.value.length,inline:""},null,8,["content"])]),_:1}),e(z,{value:1},{default:a(()=>[y(p(t.$t("queue_previous_items"))+" ",1),e(B,{color:"grey",content:S.value.length,inline:""},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])):f("",!0),$.value&&$.value.length>0?(r(),v(ve,{key:1,location:"bottom end"},{activator:a(({props:u})=>[e(de,ae({icon:"",style:{right:"3px"}},u),{default:a(()=>[e(g,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:a(()=>[e(H,null,{default:a(()=>[(r(!0),A(ie,null,ne($.value.filter(u=>u.hide!=!0),(u,n)=>(r(),v(_,{key:n,title:t.$t(u.label,u.labelArgs),disabled:u.disabled==!0,onClick:s=>u.action?u.action():""},{prepend:a(()=>[e(b,{icon:u.icon},null,8,["icon"])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1})):f("",!0)]),_:1}),e(me,null,{default:a(()=>{var u;return[o(l).activePlayerQueue&&((u=o(l).activePlayerQueue)==null?void 0:u.radio_source.length)>0?(r(),v(K,{key:0,icon:"mdi-radio-tower"},{default:a(()=>{var n,s,m,Q;return[k("b",null,p(t.$t("queue_radio_enabled")),1),ge,y(" "+p(t.$t("queue_radio_based_on",[t.$t((n=o(l).activePlayerQueue)==null?void 0:n.radio_source[0].media_type)]))+" ",1),k("b",null,[k("a",{onClick:i[1]||(i[1]=Ce=>{var G;return o(l).activePlayerQueue?j((G=o(l).activePlayerQueue)==null?void 0:G.radio_source[0]):""})},p((s=o(l).activePlayerQueue)==null?void 0:s.radio_source[0].name),1)]),((m=o(l).activePlayerQueue)==null?void 0:m.radio_source.length)>1?(r(),A("span",be," (+"+p(((Q=o(l).activePlayerQueue)==null?void 0:Q.radio_source.length)-1)+")",1)):f("",!0)]}),_:1})):f("",!0),e(ce,{height:66,items:X.value,style:{height:"100%"}},{default:a(({item:n})=>{var s;return[n.media_item?(r(),v(se,{key:n.queue_item_id,item:n.media_item||n,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"is-disabled":n.queue_item_id==((s=o(l).curQueueItem)==null?void 0:s.queue_item_id),ripple:"",onMenu:m=>R(n),onClick:m=>C(n,"play_now"),onContextmenu:h(m=>R(n),["right","prevent"])},{append:a(()=>[o(D)("bp1")?(r(),v(I,{key:0,variant:"plain",ripple:"",icon:"mdi-arrow-up",title:t.$t("queue_move_up"),onClick:[m=>o(c).queueCommandMoveUp(o(l).activePlayerQueue.queue_id,n.queue_item_id),i[2]||(i[2]=h(()=>{},["prevent"])),i[3]||(i[3]=h(()=>{},["stop"]))]},null,8,["title","onClick"])):f("",!0),e(I,{icon:"mdi-arrow-down",title:t.$t("queue_move_down"),onClick:h(m=>o(c).queueCommandMoveDown(o(l).activePlayerQueue.queue_id,n.queue_item_id),["prevent"])},null,8,["title","onClick"])]),_:2},1032,["item","is-disabled","onMenu","onClick","onContextmenu"])):(r(),v(_,{key:1},{title:a(()=>[y(p(n.name),1)]),_:2},1024))]}),_:1},8,["items"]),q.value.length==0?(r(),v(K,{key:1,type:"info"},{default:a(()=>[y(p(t.$t("no_content")),1)]),_:1})):f("",!0)]}),_:1}),e(ye,{modelValue:V.value,"onUpdate:modelValue":i[11]||(i[11]=u=>V.value=u),fullscreen:t.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:a(()=>[e(fe,null,{default:a(()=>[e(J,{sense:"",dark:"",color:"primary"},{default:a(()=>[e(I,{icon:"mdi-play-circle-outline"}),d.value?(r(),v(O,{key:0,style:{"padding-left":"10px"}},{default:a(()=>{var u;return[k("b",null,p(o(oe)(((u=d.value)==null?void 0:u.name)||"",t.$vuetify.display.mobile?20:150)),1)]}),_:1})):(r(),v(O,{key:1,style:{"padding-left":"10px"}},{default:a(()=>{var u;return[k("b",null,p(t.$t("settings")),1),y(" | "+p((u=o(l).activePlayerQueue)==null?void 0:u.display_name),1)]}),_:1})),e(I,{icon:"mdi-close",dark:"",onClick:i[4]||(i[4]=u=>E())})]),_:1}),d.value?(r(),v(_e,{key:0},{default:a(()=>[e(H,null,{default:a(()=>{var u,n;return[e(_,{title:t.$t("play_now"),onClick:i[5]||(i[5]=s=>C(d.value,"play_now"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("play_next"),onClick:i[6]||(i[6]=s=>C(d.value,"move_next"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_up"),onClick:i[7]||(i[7]=s=>C(d.value,"up"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_down"),onClick:i[8]||(i[8]=s=>C(d.value,"down"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_delete"),onClick:i[9]||(i[9]=s=>C(d.value,"delete"))},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),e(P),((n=(u=d.value)==null?void 0:u.media_item)==null?void 0:n.media_type)==o(re).TRACK?(r(),v(_,{key:0,title:t.$t("show_info"),onClick:i[10]||(i[10]=s=>{var m;return(m=d.value)!=null&&m.media_item?j(d.value.media_item):""})},{prepend:a(()=>[e(b,{style:{"padding-right":"10px"}},{default:a(()=>[e(g,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):f("",!0),e(P)]}),_:1})]),_:1})):f("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Re as default};
