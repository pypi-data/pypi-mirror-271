import{d as j,a1 as z,r as F,l as O,b as n,ah as K,a as q,I as G,a5 as H,c as s,h as f,i as V,u as i,F as w,f as d,w as a,m as _,t as m,$ as l,e as c,E as J,j as v,aK as b,g as y,a6 as Q,_ as T,a0 as W}from"./index-43311bc3.js";import{L as S,_ as $,C as X}from"./Container-9a0c901a.js";import{B as g,_ as Y}from"./Button-8f8a6597.js";import{A as Z}from"./Alert-95d71572.js";import{c as ee}from"./VMenu-7c64b634.js";import{V as te,b as h}from"./forwardRefs-651c2bd6.js";import{V as ne}from"./VCard-6b86821e.js";import{V as ie}from"./VToolbar-b1ca2657.js";/* empty css              */import"./VAlert-8faad15a.js";import"./VCardText-bdb89c1f.js";const ae=p=>(T("data-v-15cfe784"),p=p(),W(),p),se=ae(()=>y("br",null,null,-1)),oe={class:"line-clamp-1"},de={class:"line-clamp-1"},re=j({__name:"Providers",setup(p){const k=z(),u=F([]),I=O(()=>Object.values(n.providerManifests).filter(t=>!t.hidden&&(t.multi_instance||!u.value.find(o=>o.domain==t.domain))).sort((t,o)=>(t.name||n.providerManifests[t.domain].name).toUpperCase()>(o.name||n.providerManifests[o.domain].name).toUpperCase()?1:-1)),B=n.subscribe(K.PROVIDERS_UPDATED,()=>{A()});q(B);const A=async function(){u.value=await n.getProviderConfigs()},D=function(t){n.removeProviderConfig(t),u.value=u.value.filter(o=>o.instance_id!=t)},C=function(t){k.push(`/settings/editprovider/${t}`)},N=function(t){if(t.depends_on&&!n.getProvider(t.depends_on)){const o=n.getProviderName(t.depends_on);confirm(l("settings.provider_depends_on_confirm",[t.name,o]))&&k.push(`/settings/addprovider/${t.depends_on}`);return}k.push(`/settings/addprovider/${t.domain}`)},U=function(t){t.enabled=!t.enabled,n.saveProviderConfig(t.domain,{enabled:t.enabled},t.instance_id)},x=function(t){n.getData("config/providers/reload",{instance_id:t}).catch(o=>alert(o))},E=function(t){window.open(t,"_blank")};return G(()=>n.providers,t=>{t&&A()},{immediate:!0}),(t,o)=>{const L=H("hold");return s(!0),f(w,null,V(i(b),r=>(s(),f("div",{key:r,style:{"margin-bottom":"10px"}},[d(ie,{color:"transparent",density:"compact",class:"titlebar"},{title:a(()=>[_(m(i(l)(`settings.${r}providers`)),1)]),append:a(()=>[I.value.filter(e=>e.type==r).length?(s(),c(ee,{key:0},{activator:a(({props:e})=>[d(te,J(e,{color:"accent",variant:"outlined"}),{default:a(()=>[_(m(i(l)("settings.add_new_provider_button",[r])),1)]),_:2},1040)]),default:a(()=>[d(ne,{density:"compact"},{default:a(()=>[(s(!0),f(w,null,V(I.value.filter(e=>e.type==r),e=>(s(),c(S,{key:e.domain,density:"compact",style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:e.name,onClick:P=>N(e)},{prepend:a(()=>[d($,{domain:e.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):v("",!0)]),_:2},1024),r==i(b).MUSIC&&u.value.filter(e=>e.type==i(b).MUSIC&&e.domain in i(n).providerManifests&&!i(n).providerManifests[e.domain].hidden).length==0?(s(),c(Z,{key:0,icon:"mdi-radio-tower"},{default:a(()=>[y("b",null,m(i(l)("settings.no_providers")),1),se,_(" "+m(i(l)("settings.no_providers_detail")),1)]),_:1})):v("",!0),d(X,null,{default:a(()=>[(s(!0),f(w,null,V(u.value.filter(e=>e.type==r),e=>{var P;return Q((s(),c(S,{key:e.instance_id,link:"","context-menu-items":[{label:"settings.configure",labelArgs:[],action:()=>{C(e.instance_id)},icon:"mdi-cog"},{label:e.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{U(e)},icon:"mdi-cancel",disabled:i(n).providerManifests[e.domain].builtin},{label:"settings.documentation",labelArgs:[],action:()=>{E(i(n).providerManifests[e.domain].documentation)},icon:"mdi-bookshelf",disabled:!i(n).providerManifests[e.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{i(n).startSync(void 0,[e.instance_id])},icon:"mdi-sync",hide:((P=i(n).providers[e.instance_id])==null?void 0:P.available)&&r!=i(b).MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{D(e.instance_id)},icon:"mdi-delete",hide:i(n).providerManifests[e.domain].builtin||i(n).providerManifests[e.domain].load_by_default&&e.domain==e.instance_id},{label:"settings.reload",labelArgs:[],action:()=>{x(e.instance_id)},icon:"mdi-refresh"}],onClick:M=>C(e.instance_id)},{prepend:a(()=>[d($,{domain:e.domain,size:40,class:"listitem-media-thumb"},null,8,["domain"])]),title:a(()=>[y("div",oe,m(e.name||i(n).providerManifests[e.domain].name),1)]),subtitle:a(()=>[y("div",de,m(i(n).providerManifests[e.domain].description),1)]),append:a(()=>{var M;return[i(n).syncTasks.value.filter(R=>R.provider_instance==e.instance_id).length>0?(s(),c(g,{key:0,icon:"",title:i(l)("settings.sync_running")},{default:a(()=>[d(h,{color:"grey"},{default:a(()=>[_(" mdi-sync ")]),_:1})]),_:1},8,["title"])):v("",!0),e.enabled?e.last_error?(s(),c(g,{key:2,icon:"",title:e.last_error},{default:a(()=>[d(h,{color:"red"},{default:a(()=>[_(" mdi-alert-circle ")]),_:1})]),_:2},1032,["title"])):(M=i(n).providers[e.instance_id])!=null&&M.available?v("",!0):(s(),c(g,{key:3,icon:"",title:i(l)("settings.not_loaded")},{default:a(()=>[d(h,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(s(),c(g,{key:1,icon:"",title:i(l)("settings.provider_disabled")},{default:a(()=>[d(h,{color:"grey"},{default:a(()=>[_(" mdi-cancel ")]),_:1})]),_:1},8,["title"]))]}),_:2},1032,["context-menu-items","onClick"])),[[L,()=>{C(e.instance_id)}]])}),128))]),_:2},1024)]))),128)}}});const ye=Y(re,[["__scopeId","data-v-15cfe784"]]);export{ye as default};
