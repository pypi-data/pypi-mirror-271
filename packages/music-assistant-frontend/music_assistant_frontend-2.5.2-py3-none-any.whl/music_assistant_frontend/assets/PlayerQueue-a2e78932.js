import{d as Y,ae as Z,af as ee,r as w,z as U,s as a,o as te,b as f,ag as D,a as ue,I as ae,c as r,g as x,f as e,w as l,G as y,t as p,u as o,e as v,j as c,E as le,F as ie,h as ne,i as k,ac as h,D as A,V as oe,M as re}from"./index-1fa25223.js";import{L as se}from"./ListviewItem-fa4b6d44.js";import{B as de}from"./Button-0d671d73.js";import{L as _}from"./ListItem-9f85535e.js";import{C as me}from"./Container-55c3ff81.js";import{A as G}from"./Alert-501a5edb.js";import{V as B}from"./VBadge-3b97e665.js";import{a as K,V as pe}from"./VTabs-6872acef.js";import{o as g,t as I,v as b}from"./VListItem-53d44b85.js";import{a as H,V as P}from"./VList-f519ecda.js";import{V as ve}from"./VMenu-85495654.js";import{V as J,a as O}from"./VToolbar-a7b4dbd4.js";import{V as fe}from"./VVirtualScroll-f6a01209.js";import{V as ce}from"./VCard-99bbc2f5.js";import{a as _e}from"./VCardText-bbb7eb1a.js";import{V as ye}from"./VDialog-0a55bc34.js";import"./helpers-f9fbf435.js";import"./VLabel-148b546a.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./VTooltip-c87f5f44.js";import"./VCheckboxBtn-4c4cfeff.js";/* empty css              */import"./VAlert-034cbd55.js";const ge=k("br",null,null,-1),be={key:0},Ge=Y({__name:"PlayerQueue",setup(qe){const{t:W}=Z(),L=ee(),M=w(0),d=w(),V=w(!1),$=w([]),q=w([]),T=U(()=>a.activePlayerQueue?q.value.slice(a.activePlayerQueue.current_index):[]),S=U(()=>a.activePlayerQueue?q.value.slice(0,a.activePlayerQueue.current_index):[]),X=U(()=>M.value==1?S.value:T.value);te(()=>{const t=f.subscribe_multi([D.QUEUE_UPDATED,D.QUEUE_ITEMS_UPDATED],i=>{var u;i.object_id==((u=a.activePlayerQueue)==null?void 0:u.queue_id)&&(i.event==D.QUEUE_ITEMS_UPDATED?N():F())});ue(t)});const N=async function(){a.activePlayerQueue?(q.value=[],await f.getPlayerQueueItems(a.activePlayerQueue.queue_id,t=>{q.value.push(...t)})):q.value=[]},R=function(t){d.value=t,V.value=!0},j=function(t){E(),L.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},C=function(t,i){var u,n,s,m,Q;E(),!(!t||!a.activePlayerQueue)&&(i=="play_now"?f.queueCommandPlayIndex((u=a.activePlayerQueue)==null?void 0:u.queue_id,t.queue_item_id):i=="move_next"?f.queueCommandMoveNext((n=a.activePlayerQueue)==null?void 0:n.queue_id,t.queue_item_id):i=="up"?f.queueCommandMoveUp((s=a.activePlayerQueue)==null?void 0:s.queue_id,t.queue_item_id):i=="down"?f.queueCommandMoveDown((m=a.activePlayerQueue)==null?void 0:m.queue_id,t.queue_item_id):i=="delete"&&f.queueCommandDelete((Q=a.activePlayerQueue)==null?void 0:Q.queue_id,t.queue_item_id))},F=function(){$.value=[{label:"settings.player_settings",labelArgs:[],action:()=>{L.push(`/settings/editplayer/${a.activePlayerQueue.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{f.queueCommandClear(a.activePlayerQueue.queue_id)},icon:"mdi-cancel"},{label:a.activePlayerQueue.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{f.queueCommandShuffleToggle(a.activePlayerQueue.queue_id)},icon:a.activePlayerQueue.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[W(`repeatmode.${a.activePlayerQueue.repeat_mode}`)],action:()=>{f.queueCommandRepeatToggle(a.activePlayerQueue.queue_id)},icon:a.activePlayerQueue.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"}]},E=function(){d.value=void 0,V.value=!1};return ae(()=>a.activePlayerQueue,t=>{t&&(N(),F())},{immediate:!0}),(t,i)=>(r(),x("section",null,[e(J,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:l(()=>{var u;return[y(p(t.$t("queue"))+" | "+p((u=o(a).selectedPlayer)==null?void 0:u.display_name)+" ",1),o(A)("bp6")?c("",!0):(r(),v(B,{key:0,color:"grey",content:T.value.length,inline:""},null,8,["content"]))]}),append:l(()=>[o(A)("bp6")?(r(),v(pe,{key:0,modelValue:M.value,"onUpdate:modelValue":i[0]||(i[0]=u=>M.value=u),"show-arrows":"",grow:""},{default:l(()=>[e(K,{value:0},{default:l(()=>[y(p(t.$t("queue_next_items"))+" ",1),e(B,{color:"grey",content:T.value.length,inline:""},null,8,["content"])]),_:1}),e(K,{value:1},{default:l(()=>[y(p(t.$t("queue_previous_items"))+" ",1),e(B,{color:"grey",content:S.value.length,inline:""},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])):c("",!0),$.value&&$.value.length>0?(r(),v(ve,{key:1,location:"bottom end"},{activator:l(({props:u})=>[e(de,le({icon:"",style:{right:"3px"}},u),{default:l(()=>[e(g,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:l(()=>[e(H,null,{default:l(()=>[(r(!0),x(ie,null,ne($.value.filter(u=>u.hide!=!0),(u,n)=>(r(),v(_,{key:n,title:t.$t(u.label,u.labelArgs||[]),disabled:u.disabled==!0,onClick:s=>u.action?u.action():""},{prepend:l(()=>[e(b,{icon:u.icon},null,8,["icon"])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1})):c("",!0)]),_:1}),e(me,null,{default:l(()=>{var u;return[o(a).activePlayerQueue&&((u=o(a).activePlayerQueue)==null?void 0:u.radio_source.length)>0?(r(),v(G,{key:0,icon:"mdi-radio-tower"},{default:l(()=>{var n,s,m,Q;return[k("b",null,p(t.$t("queue_radio_enabled")),1),ge,y(" "+p(t.$t("queue_radio_based_on",[t.$t((n=o(a).activePlayerQueue)==null?void 0:n.radio_source[0].media_type)]))+" ",1),k("b",null,[k("a",{onClick:i[1]||(i[1]=Ce=>{var z;return o(a).activePlayerQueue?j((z=o(a).activePlayerQueue)==null?void 0:z.radio_source[0]):""})},p((s=o(a).activePlayerQueue)==null?void 0:s.radio_source[0].name),1)]),((m=o(a).activePlayerQueue)==null?void 0:m.radio_source.length)>1?(r(),x("span",be," (+"+p(((Q=o(a).activePlayerQueue)==null?void 0:Q.radio_source.length)-1)+")",1)):c("",!0)]}),_:1})):c("",!0),e(fe,{height:66,items:X.value,style:{height:"100%"}},{default:l(({item:n})=>{var s;return[n.media_item?(r(),v(se,{key:n.queue_item_id,item:n.media_item||n,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"is-disabled":n.queue_item_id==((s=o(a).curQueueItem)==null?void 0:s.queue_item_id),ripple:"",onMenu:m=>R(n),onClick:m=>C(n,"play_now"),onContextmenu:h(m=>R(n),["right","prevent"])},{append:l(()=>[o(A)("bp1")?(r(),v(I,{key:0,variant:"plain",ripple:"",icon:"mdi-arrow-up",title:t.$t("queue_move_up"),onClick:[m=>o(f).queueCommandMoveUp(o(a).activePlayerQueue.queue_id,n.queue_item_id),i[2]||(i[2]=h(()=>{},["prevent"])),i[3]||(i[3]=h(()=>{},["stop"]))]},null,8,["title","onClick"])):c("",!0),e(I,{icon:"mdi-arrow-down",title:t.$t("queue_move_down"),onClick:h(m=>o(f).queueCommandMoveDown(o(a).activePlayerQueue.queue_id,n.queue_item_id),["prevent"])},null,8,["title","onClick"])]),_:2},1032,["item","is-disabled","onMenu","onClick","onContextmenu"])):(r(),v(_,{key:1},{title:l(()=>[y(p(n.name),1)]),_:2},1024))]}),_:1},8,["items"]),q.value.length==0?(r(),v(G,{key:1,type:"info"},{default:l(()=>[y(p(t.$t("no_content")),1)]),_:1})):c("",!0)]}),_:1}),e(ye,{modelValue:V.value,"onUpdate:modelValue":i[11]||(i[11]=u=>V.value=u),fullscreen:t.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:l(()=>[e(ce,null,{default:l(()=>[e(J,{sense:"",dark:"",color:"primary"},{default:l(()=>[e(I,{icon:"mdi-play-circle-outline"}),d.value?(r(),v(O,{key:0,style:{"padding-left":"10px"}},{default:l(()=>{var u;return[k("b",null,p(o(oe)(((u=d.value)==null?void 0:u.name)||"",t.$vuetify.display.mobile?20:150)),1)]}),_:1})):(r(),v(O,{key:1,style:{"padding-left":"10px"}},{default:l(()=>{var u;return[k("b",null,p(t.$t("settings")),1),y(" | "+p((u=o(a).activePlayerQueue)==null?void 0:u.display_name),1)]}),_:1})),e(I,{icon:"mdi-close",dark:"",onClick:i[4]||(i[4]=u=>E())})]),_:1}),d.value?(r(),v(_e,{key:0},{default:l(()=>[e(H,null,{default:l(()=>{var u,n;return[e(_,{title:t.$t("play_now"),onClick:i[5]||(i[5]=s=>C(d.value,"play_now"))},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("play_next"),onClick:i[6]||(i[6]=s=>C(d.value,"move_next"))},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_up"),onClick:i[7]||(i[7]=s=>C(d.value,"up"))},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_move_down"),onClick:i[8]||(i[8]=s=>C(d.value,"down"))},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),e(P),e(_,{title:t.$t("queue_delete"),onClick:i[9]||(i[9]=s=>C(d.value,"delete"))},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),e(P),((n=(u=d.value)==null?void 0:u.media_item)==null?void 0:n.media_type)==o(re).TRACK?(r(),v(_,{key:0,title:t.$t("show_info"),onClick:i[10]||(i[10]=s=>{var m;return(m=d.value)!=null&&m.media_item?j(d.value.media_item):""})},{prepend:l(()=>[e(b,{style:{"padding-right":"10px"}},{default:l(()=>[e(g,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):c("",!0),e(P)]}),_:1})]),_:1})):c("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Ge as default};
