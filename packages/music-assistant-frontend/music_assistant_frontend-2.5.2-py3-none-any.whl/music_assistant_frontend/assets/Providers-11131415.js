import{d as L,af as z,r as R,z as j,b as i,ag as F,a as O,I as X,c as s,g as v,h as M,u as o,F as P,f as r,w as a,G as _,t as p,$ as l,e as c,E as Y,j as b,aH as g,i as k,p as G,k as H}from"./index-1fa25223.js";import{_ as A,C as T}from"./Container-55c3ff81.js";import{B as y}from"./Button-0d671d73.js";import{L as q}from"./ListItem-9f85535e.js";import{A as J}from"./Alert-501a5edb.js";import{e as K}from"./eventbus-d154090d.js";import{V as Q}from"./VMenu-85495654.js";import{t as W,V as Z,o as h}from"./VListItem-53d44b85.js";import{V as ee}from"./VCard-99bbc2f5.js";import{V as ne}from"./VToolbar-a7b4dbd4.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css              */import"./VAlert-034cbd55.js";import"./VCardText-bbb7eb1a.js";const ie=f=>(G("data-v-572e256e"),f=f(),H(),f),ae=ie(()=>k("br",null,null,-1)),oe={class:"line-clamp-1"},se={class:"line-clamp-1"},re=L({__name:"Providers",setup(f){const C=z(),u=R([]),V=j(()=>Object.values(i.providerManifests).filter(e=>!e.hidden&&(e.multi_instance||!u.value.find(t=>t.domain==e.domain))).sort((e,t)=>(e.name||i.providerManifests[e.domain].name).toUpperCase()>(t.name||i.providerManifests[t.domain].name).toUpperCase()?1:-1)),S=i.subscribe(F.PROVIDERS_UPDATED,()=>{I()});O(S);const I=async function(){u.value=await i.getProviderConfigs()},$=function(e){i.removeProviderConfig(e),u.value=u.value.filter(t=>t.instance_id!=e)},w=function(e){C.push(`/settings/editprovider/${e}`)},B=function(e){if(e.depends_on&&!i.getProvider(e.depends_on)){const t=i.getProviderName(e.depends_on);confirm(l("settings.provider_depends_on_confirm",[e.name,t]))&&C.push(`/settings/addprovider/${e.depends_on}`);return}C.push(`/settings/addprovider/${e.domain}`)},N=function(e){e.enabled=!e.enabled,i.saveProviderConfig(e.domain,{enabled:e.enabled},e.instance_id)},U=function(e){i.getData("config/providers/reload",{instance_id:e}).catch(t=>alert(t))},E=function(e){window.open(e,"_blank")},x=function(e,t){var n;const d=[{label:"settings.configure",labelArgs:[],action:()=>{w(t.instance_id)},icon:"mdi-cog"},{label:t.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{N(t)},icon:"mdi-cancel",disabled:i.providerManifests[t.domain].builtin},{label:"settings.documentation",labelArgs:[],action:()=>{E(i.providerManifests[t.domain].documentation)},icon:"mdi-bookshelf",disabled:!i.providerManifests[t.domain].documentation},{label:"settings.sync",labelArgs:[],action:()=>{i.startSync(void 0,[t.instance_id])},icon:"mdi-sync",hide:((n=i.providers[t.instance_id])==null?void 0:n.available)&&t.type!=g.MUSIC},{label:"settings.delete",labelArgs:[],action:()=>{$(t.instance_id)},icon:"mdi-delete",hide:i.providerManifests[t.domain].builtin||i.providerManifests[t.domain].load_by_default&&t.domain==t.instance_id},{label:"settings.reload",labelArgs:[],action:()=>{U(t.instance_id)},icon:"mdi-refresh"}];K.emit("contextmenu",{items:d,posX:e.clientX,posY:e.clientY})};return X(()=>i.providers,e=>{e&&I()},{immediate:!0}),(e,t)=>(s(!0),v(P,null,M(o(g),d=>(s(),v("div",{key:d,style:{"margin-bottom":"10px"}},[r(ne,{color:"transparent",density:"compact",class:"titlebar"},{title:a(()=>[_(p(o(l)(`settings.${d}providers`)),1)]),append:a(()=>[V.value.filter(n=>n.type==d).length?(s(),c(Q,{key:0,scrim:""},{activator:a(({props:n})=>[r(W,Y({ref_for:!0},n,{color:"accent",variant:"outlined"}),{default:a(()=>[_(p(o(l)("settings.add_new_provider_button",[d])),1)]),_:2},1040)]),default:a(()=>[r(ee,{density:"compact"},{default:a(()=>[(s(!0),v(P,null,M(V.value.filter(n=>n.type==d),n=>(s(),c(Z,{key:n.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:n.name,onClick:m=>B(n)},{prepend:a(()=>[r(A,{domain:n.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:2},1024)]),_:2},1024)):b("",!0)]),_:2},1024),d==o(g).MUSIC&&u.value.filter(n=>n.type==o(g).MUSIC&&n.domain in o(i).providerManifests&&!o(i).providerManifests[n.domain].hidden).length==0?(s(),c(J,{key:0,icon:"mdi-radio-tower"},{default:a(()=>[k("b",null,p(o(l)("settings.no_providers")),1),ae,_(" "+p(o(l)("settings.no_providers_detail")),1)]),_:1})):b("",!0),r(T,null,{default:a(()=>[(s(!0),v(P,null,M(u.value.filter(n=>n.type==d),n=>(s(),c(q,{key:n.instance_id,"show-menu-btn":"",link:"",onMenu:m=>x(m,n),onClick:m=>w(n.instance_id)},{prepend:a(()=>[r(A,{domain:n.domain,size:40,class:"listitem-media-thumb"},null,8,["domain"])]),title:a(()=>[k("div",oe,p(n.name||o(i).providerManifests[n.domain].name),1)]),subtitle:a(()=>[k("div",se,p(o(i).providerManifests[n.domain].description),1)]),append:a(()=>{var m;return[o(i).syncTasks.value.filter(D=>D.provider_instance==n.instance_id).length>0?(s(),c(y,{key:0,icon:"",title:o(l)("settings.sync_running")},{default:a(()=>[r(h,{color:"grey"},{default:a(()=>[_(" mdi-sync ")]),_:1})]),_:1},8,["title"])):b("",!0),n.enabled?n.last_error?(s(),c(y,{key:2,icon:"",title:n.last_error},{default:a(()=>[r(h,{color:"red"},{default:a(()=>[_(" mdi-alert-circle ")]),_:1})]),_:2},1032,["title"])):(m=o(i).providers[n.instance_id])!=null&&m.available?b("",!0):(s(),c(y,{key:3,icon:"",title:o(l)("settings.not_loaded")},{default:a(()=>[r(h,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(s(),c(y,{key:1,icon:"",title:o(l)("settings.provider_disabled")},{default:a(()=>[r(h,{color:"grey"},{default:a(()=>[_(" mdi-cancel ")]),_:1})]),_:1},8,["title"]))]}),_:2},1032,["onMenu","onClick"]))),128))]),_:2},1024)]))),128))}});const Ce=te(re,[["__scopeId","data-v-572e256e"]]);export{Ce as default};
